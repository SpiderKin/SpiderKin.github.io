<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="四、函数查询一、概要 函数是一种有零个或多个参数并且有一个返回值的程序,函数主要分为两大类单行函数,多行函数(聚合函数)  二、单行函数1、定义​    单行函数: 对每一个函数应用在表的记录中时，只能输入一行结果，返回一个结果。 2、分类 字符函数 数值函数 日期函数 转换函数 通用函数  2.3、字符函数1、UPPER 说明 1将输入的字符串变为大写返回；  作用 1在一般的使用之中，用户输入">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/2018/08/27/6.查询（函数）/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="四、函数查询一、概要 函数是一种有零个或多个参数并且有一个返回值的程序,函数主要分为两大类单行函数,多行函数(聚合函数)  二、单行函数1、定义​    单行函数: 对每一个函数应用在表的记录中时，只能输入一行结果，返回一个结果。 2、分类 字符函数 数值函数 日期函数 转换函数 通用函数  2.3、字符函数1、UPPER 说明 1将输入的字符串变为大写返回；  作用 1在一般的使用之中，用户输入">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2018-08-24T08:55:52.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">
<meta name="twitter:description" content="四、函数查询一、概要 函数是一种有零个或多个参数并且有一个返回值的程序,函数主要分为两大类单行函数,多行函数(聚合函数)  二、单行函数1、定义​    单行函数: 对每一个函数应用在表的记录中时，只能输入一行结果，返回一个结果。 2、分类 字符函数 数值函数 日期函数 转换函数 通用函数  2.3、字符函数1、UPPER 说明 1将输入的字符串变为大写返回；  作用 1在一般的使用之中，用户输入">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-6.查询（函数）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/27/6.查询（函数）/" class="article-date">
  <time datetime="2018-08-27T09:56:37.410Z" itemprop="datePublished">2018-08-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="四、函数查询"><a href="#四、函数查询" class="headerlink" title="四、函数查询"></a>四、函数查询</h1><h2 id="一、概要"><a href="#一、概要" class="headerlink" title="一、概要"></a>一、概要</h2><blockquote>
<p>函数是一种有零个或多个参数并且有一个返回值的程序,函数主要分为两大类单行函数,多行函数(聚合函数)</p>
</blockquote>
<h2 id="二、单行函数"><a href="#二、单行函数" class="headerlink" title="二、单行函数"></a>二、单行函数</h2><h3 id="1、定义"><a href="#1、定义" class="headerlink" title="1、定义"></a>1、定义</h3><p>​    单行函数: 对每一个函数应用在表的记录中时，只能输入一行结果，返回一个结果。</p>
<h3 id="2、分类"><a href="#2、分类" class="headerlink" title="2、分类"></a>2、分类</h3><ol>
<li>字符函数</li>
<li>数值函数</li>
<li>日期函数</li>
<li>转换函数</li>
<li>通用函数</li>
</ol>
<h3 id="2-3、字符函数"><a href="#2-3、字符函数" class="headerlink" title="2.3、字符函数"></a>2.3、字符函数</h3><h4 id="1、UPPER"><a href="#1、UPPER" class="headerlink" title="1、UPPER"></a>1、UPPER</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">将输入的字符串变为大写返回；</span><br></pre></td></tr></table></figure>
</li>
<li><p>作用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在一般的使用之中，用户输入数据的时候不关心数据本身存放的是大写还是小写</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">upper（列 | 字符串）</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<p>1、将abcd改变成大写</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT UPPER(&apos;abcd&apos;) FROM dual</span><br></pre></td></tr></table></figure>
<p>2、查询姓名为simth的员工信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * </span><br><span class="line">FROM  emp </span><br><span class="line">WHERE ename = UPPER(&apos;smith&apos;);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="2、LOWER"><a href="#2、LOWER" class="headerlink" title="2、LOWER"></a>2、LOWER</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">将输入的字符串变为小写返回</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LOWER(字符串 | 列)</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<p>1、将员工姓名转化成小写显示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT lower(ename)</span><br><span class="line">FROM  emp</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="3、REPLACE"><a href="#3、REPLACE" class="headerlink" title="3、REPLACE"></a>3、REPLACE</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">字符串进行替换</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">REPLACE(字符串 | 列,   被替换的字符串，  用来替换的字符串)</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<p>使用字母’*’替换掉姓名中的所有字母’s’</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT REPLACE(ename,&apos;S&apos;,&apos;*&apos;) FROM emp</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="4、LENGTH"><a href="#4、LENGTH" class="headerlink" title="4、LENGTH"></a>4、LENGTH</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">求出字符串的长度</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LENGTH(字符串 | 列)</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<p>查询出每个雇员姓名的长度</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT LENGTH(ename) </span><br><span class="line">FROM emp;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="5、INITCAP"><a href="#5、INITCAP" class="headerlink" title="5、INITCAP"></a>5、INITCAP</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">首字母大写</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INITCAP(字符串 | 列)</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<p>将员工的姓名全部大写字母开头</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT initcap(ename) </span><br><span class="line">FROM emp;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="6、SUBSTR（注意：从0和1开始截取都是从字符串的第一位开始）"><a href="#6、SUBSTR（注意：从0和1开始截取都是从字符串的第一位开始）" class="headerlink" title="6、SUBSTR（注意：从0和1开始截取都是从字符串的第一位开始）"></a>6、SUBSTR（注意：从0和1开始截取都是从字符串的第一位开始）</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">字符串截取,开始点可以是正也可以是负,如果是负表示从后面开始截取 ,如果长度不写,默认截取到末尾</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SUBSTR(字符串 | 列，开始点, 长度)</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<p>1、从开始点一直截取到结尾</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT SUBSTR(&apos;abcdefg&apos;,2) from  dual; --bcdefg</span><br></pre></td></tr></table></figure>
<p>2、从开始点截取到结束点，截取部分内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT SUBSTR(&apos;abcdefg&apos;,2,4) from  dual;--bcde</span><br></pre></td></tr></table></figure>
<p>3、要求截取每个雇员姓名的后2个字母</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT ename,SUBSTR(ename,LENGTH(ename)-1) FROM emp;</span><br><span class="line">等价于</span><br><span class="line">SELECT ename,SUBSTR(ename,-2) FROM emp;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="2-4、数值函数"><a href="#2-4、数值函数" class="headerlink" title="2.4、数值函数"></a>2.4、数值函数</h3><h4 id="1、ROUND"><a href="#1、ROUND" class="headerlink" title="1、ROUND"></a>1、ROUND</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">四舍五入的操作 默认保留0位</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROUND(数字 | 列 [,保留小数的位数])</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT  ROUND(100.12),</span><br><span class="line">ROUND(100.12 ,1) ,</span><br><span class="line">ROUND(-100.56), </span><br><span class="line">ROUND(-100.56,1), </span><br><span class="line">ROUND(-100.567123,3)</span><br><span class="line">FROM DUAL;</span><br><span class="line">100           100.1           -101           -100.6             -100.567</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="2、TRUNC"><a href="#2、TRUNC" class="headerlink" title="2、TRUNC"></a>2、TRUNC</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">舍弃指定位置的内容</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TRUNC(数字 | 列 [,保留小数的位数])</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT TRUNC(903.53567),TRUNC(-903.53567), TRUNC(903.53567,2), TRUNC(-90353567,-1) </span><br><span class="line">FROM dual;</span><br><span class="line"></span><br><span class="line">903              -903             903.53           -90353560</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="3、MOD"><a href="#3、MOD" class="headerlink" title="3、MOD"></a>3、MOD</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">取余数</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MOD(数字 1，数字2)</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT MOD(10,3) FROM dual</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="2-5、日期函数"><a href="#2-5、日期函数" class="headerlink" title="2.5、日期函数"></a>2.5、日期函数</h3><h4 id="1、NOW："><a href="#1、NOW：" class="headerlink" title="1、NOW："></a>1、NOW：</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">返回服务器的当前日期和时间(fsp指定小数秒的精度，取值0--6)</span><br><span class="line">格式 ‘YYYY-MM-DD HH:MM:SS’或者‘YYYYMMDDHHMMSS’</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NOW([fsp])</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- now()的显示格式是‘YYYY-MM-DD HH:MM:SS’</span><br><span class="line">select now();</span><br><span class="line">-- now()+0的显示格式是‘YYYYMMDDHHMMSS’</span><br><span class="line">select now()+0;</span><br><span class="line">-- 指定小数秒的精度  2018-04-19 01:55:46.658198</span><br><span class="line">select now(6);</span><br></pre></td></tr></table></figure>
</li>
<li><p>其它相同的还有</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CURRENT_TIMESTAMP  </span><br><span class="line">CURRENT_TIMESTAMP()</span><br><span class="line">LOCALTIMESTAMP</span><br><span class="line">LOCALTIMESTAMP()</span><br><span class="line">LOCALTIME</span><br><span class="line">LOCALTIME()</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="2、CURTIME"><a href="#2、CURTIME" class="headerlink" title="2、CURTIME"></a>2、CURTIME</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">返回当前时间，只包含时分秒(fsp指定小数秒的精度，取值0--6)</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CURTIME([fsp])</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select curtime()</span><br><span class="line"># 01:55:47</span><br><span class="line">select curtime()+0</span><br><span class="line"># 163301</span><br><span class="line">select curtime(2) 　 </span><br><span class="line"># 01:55:47.90</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="2、CURDATE"><a href="#2、CURDATE" class="headerlink" title="2、CURDATE"></a>2、CURDATE</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">返回当前日期，只包含年月日</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CURDATE()</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select curdate()</span><br><span class="line">select curdate()+0</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="3、选取日期时间的各个部分"><a href="#3、选取日期时间的各个部分" class="headerlink" title="3、选取日期时间的各个部分"></a>3、选取日期时间的各个部分</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">日期、时间、年、季度、月、日、小时、分钟、秒、微秒</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">SELECT now(),date(now()); -- 日期</span><br><span class="line">SELECT now(),time(now()); -- 时间</span><br><span class="line">SELECT now(),year(now()); -- 年</span><br><span class="line">SELECT now(),quarter(now()); -- 季度</span><br><span class="line">SELECT now(),month(now()); -- 月</span><br><span class="line">SELECT now(),week(now()); -- 周</span><br><span class="line">SELECT now(),day(now()); -- 日</span><br><span class="line">SELECT now(),hour(now()); -- 小时</span><br><span class="line">SELECT now(),minute(now()); -- 分钟</span><br><span class="line">SELECT now(),second(now()); -- 秒</span><br><span class="line">SELECT now(),microsecond(now()); -- 微秒</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="2-6、转换函数"><a href="#2-6、转换函数" class="headerlink" title="2.6、转换函数"></a>2.6、转换函数</h3><p>转换函数将值从一种数据类型转换为另外一种数据类型</p>
<h4 id="1、date-format-date-format"><a href="#1、date-format-date-format" class="headerlink" title="1、date_format(date, format)"></a>1、date_format(date, format)</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">把日期和数字转换为制定格式的字符串。format是格式化字符串</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">date_format(date, format)</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<p>对日期的处理</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select date_format(now(), &apos;%Y-%m-%d&apos;);</span><br><span class="line">-- 2017-07-24</span><br><span class="line">select date_format(now(), &apos;%Y-%m-%d %H:%I:%S&apos;);</span><br><span class="line">-- 2017-07-24 15:03:44</span><br></pre></td></tr></table></figure>
</li>
<li><p>附表</p>
<p>|      | 值     | 含义                                                         |<br>| —- | —— | ———————————————————— |<br>| 秒   | %S %s  | 两位数字形式的秒（ 00,01, …, 59）                          |<br>| 分   | % I %i | 两位数字形式的分（ 00,01, …, 59）                          |<br>| 小时 | %H %h  | 24小时制， 12小时制                                          |<br>| 天   | %d     | 两位数字表示月中天数（01,02, …,31）                        |<br>| 月   | %m     | 两位数字表示月份（01,02, …,12）                            |<br>| 年   | %Y  %y | 四位数字表示的年份（2017,2018…） 两位数字表示的年份（15,16…） |</p>
</li>
</ol>
<h4 id="2、str-to-date-str-format"><a href="#2、str-to-date-str-format" class="headerlink" title="2、str_to_date(str, format)"></a>2、str_to_date(str, format)</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">将一个字符串变为DATE型数据</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">str_to_date(str,[,format]) --注意：格式要和字符串日期的格式一致才能解析成功。</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<p>将字符串日期转化为年月日</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select str_to_date(&apos;2018-12-25&apos;, &apos;%Y-%m-%d&apos;)</span><br></pre></td></tr></table></figure>
<p>将字符串日期+时间转化成年与日时分秒</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select str_to_date(&apos;2018-12-25 13:25:59&apos;, &apos;%Y-%m-%d %H:%i:%s&apos;)</span><br><span class="line">-- 注意年是大写‘Y’，小时也必须是大写‘H’ (如果其他为大写，则得到结果为null)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="2-7、通用函数"><a href="#2-7、通用函数" class="headerlink" title="2.7、通用函数"></a>2.7、通用函数</h3><h4 id="1、ifnull"><a href="#1、ifnull" class="headerlink" title="1、ifnull"></a>1、ifnull</h4><p>主要针对null值的处理，null加任何值等于null</p>
<ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">如果X为空，返回value，否则返回VALUE</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NVL(col|字符串,VALUE) --相当于三则运算</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<p>对工资是2000元以下的员工，如果没发奖金，每人奖金100元</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT ename,job,sal,ifnull(comm,100) FROM emp WHERE sal&lt;2000;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="三、分组函数"><a href="#三、分组函数" class="headerlink" title="三、分组函数"></a>三、分组函数</h2><h3 id="1、什么叫分组函数"><a href="#1、什么叫分组函数" class="headerlink" title="1、什么叫分组函数"></a>1、什么叫分组函数</h3><blockquote>
<p>对一组（多行）数据的处理计算并返回一行数据</p>
<p>聚合函数也叫分组函数，有的也叫集合函数，它的数据源一般来自多组数据，但返回的时候一般是一组数据，聚合函数对一组行中的某个列执行计算并返回单一的值。聚合函数经常与 SELECT 语句的 GROUP BY 子句一同使用,所以有的时候也把其称之为分组函数</p>
</blockquote>
<h3 id="2、分类-1"><a href="#2、分类-1" class="headerlink" title="2、分类"></a>2、分类</h3><blockquote>
<table>
<thead>
<tr>
<th>函数名称</th>
<th>返回值（结果）类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>SUM(DISTINCT \</td>
<td>ALL 列名)</td>
<td>数值</td>
<td>对所有数值求和</td>
</tr>
<tr>
<td>COUNT(DISTINCT \</td>
<td>ALL 列名) 或者 COUNT(*)</td>
<td>数值</td>
<td>计数，求数据行数</td>
</tr>
<tr>
<td>MAX(DISTINCT \</td>
<td>ALL   数值日期列)</td>
<td>数值</td>
<td>求最大值</td>
</tr>
<tr>
<td>MIN(DISTINCT \</td>
<td>ALL  数值日期列)</td>
<td>数值</td>
<td>求最小值</td>
</tr>
<tr>
<td>AVG(DISTINCT \</td>
<td>ALL  数值列)</td>
<td>数值</td>
<td>求平均值</td>
</tr>
</tbody>
</table>
</blockquote>
<h3 id="3、-SUM-求总和"><a href="#3、-SUM-求总和" class="headerlink" title="3、 SUM(求总和)"></a>3、 SUM(求总和)</h3><h4 id="1、-说明"><a href="#1、-说明" class="headerlink" title="1、 说明"></a>1、 说明</h4><ol>
<li>ALL表示对所有值求和</li>
<li>DISTINCT表示只对不同值求和(相同值只取一次)</li>
</ol>
<h4 id="2、示例代码"><a href="#2、示例代码" class="headerlink" title="2、示例代码"></a>2、示例代码</h4><ol>
<li><p>计算雇员姓名为 ‘SMITH’和 ‘ALLEN’ 两个人的基本薪资和</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">SUM</span>(sal) </span><br><span class="line"><span class="keyword">FROM</span> emp </span><br><span class="line"><span class="keyword">WHERE</span> ename <span class="keyword">IN</span>(<span class="string">'SMITH'</span>,<span class="string">'ALLEN'</span>);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="4、-COUNT-统计行数"><a href="#4、-COUNT-统计行数" class="headerlink" title="4、 COUNT(统计行数)"></a>4、 COUNT(统计行数)</h3><h4 id="1、-说明-1"><a href="#1、-说明-1" class="headerlink" title="1、 说明"></a>1、 说明</h4><ol>
<li><p>ALL对所有记录，数组做统计 （默认）</p>
</li>
<li><p>DISTINCT只对不同值统计(相同值只取一次)</p>
</li>
<li><p>COUNT(DISTINCT | ALL 列名)      ———会忽略null值进行统计</p>
<p>或者 COUNT(*)   ——————————–不需要考虑null值问题（开发使用较多）</p>
</li>
</ol>
<h4 id="2、-示例代码"><a href="#2、-示例代码" class="headerlink" title="2、 示例代码"></a>2、 示例代码</h4><ol>
<li><p>显示emp表中的总条数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*) </span><br><span class="line"><span class="keyword">FROM</span> emp</span><br></pre></td></tr></table></figure>
</li>
<li><p>统计 emp 职位类型的个数。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(<span class="keyword">DISTINCT</span> job) </span><br><span class="line"><span class="keyword">FROM</span> emp;</span><br></pre></td></tr></table></figure>
</li>
<li><p>统计 emp 职位为 SALESMAN 的雇员个数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*) </span><br><span class="line"><span class="keyword">FROM</span> emp </span><br><span class="line"><span class="keyword">WHERE</span> job=<span class="string">'SALESMAN'</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>统计 emp 中 有佣金的雇员的个数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(comm) </span><br><span class="line"><span class="keyword">FROM</span> emp;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="5、-MAX-求最大值"><a href="#5、-MAX-求最大值" class="headerlink" title="5、 MAX(求最大值)"></a>5、 MAX(求最大值)</h3><h4 id="1、-说明-2"><a href="#1、-说明-2" class="headerlink" title="1、 说明"></a>1、 说明</h4><ol>
<li>ALL表示对所有的值求最大值 （默认）</li>
<li>DISTINCT表示对不同的值求最大值,相同的只取一次</li>
</ol>
<h4 id="2、-示例代码-1"><a href="#2、-示例代码-1" class="headerlink" title="2、 示例代码"></a>2、 示例代码</h4><ol>
<li><p>查询所有雇员中最高的薪资</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>　<span class="keyword">MAX</span>(sal)</span><br><span class="line"><span class="keyword">FROM</span> emp;</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示所有工资不同的员工中工资最高的</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MAX</span>(<span class="keyword">DISTINCT</span> SAL) </span><br><span class="line"><span class="keyword">FROM</span> EMP;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="6、-AVG-求平均值"><a href="#6、-AVG-求平均值" class="headerlink" title="6、 AVG(求平均值)"></a>6、 AVG(求平均值)</h3><h4 id="1、-说明-3"><a href="#1、-说明-3" class="headerlink" title="1、 说明"></a>1、 说明</h4><ol>
<li>ALL表示对所有的值求平均值 （ 默认）</li>
<li>DISTINCT表示对不同的值求最大值,相同的只取一次</li>
</ol>
<h4 id="2、-示例代码-2"><a href="#2、-示例代码-2" class="headerlink" title="2、 示例代码"></a>2、 示例代码</h4><ol>
<li><p>求所有员工工资的平均值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>  (sal) </span><br><span class="line"><span class="keyword">FROM</span>  emp;</span><br></pre></td></tr></table></figure>
</li>
<li><p>求不重复的员工工资的平均值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>  <span class="keyword">AVG</span>(<span class="keyword">DISTINCT</span> sal) </span><br><span class="line"><span class="keyword">FROM</span>  emp;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="7、MIN-求最小值"><a href="#7、MIN-求最小值" class="headerlink" title="7、MIN(求最小值)"></a>7、MIN(求最小值)</h3><h4 id="1、-说明-4"><a href="#1、-说明-4" class="headerlink" title="1、 说明"></a>1、 说明</h4><ol>
<li>ALL表示对所有的值求最小值（ 默认）</li>
<li>DISTINCT表示对不同的值求最小值,相同的只取一次</li>
</ol>
<h4 id="2、-示例代码-3"><a href="#2、-示例代码-3" class="headerlink" title="2、 示例代码"></a>2、 示例代码</h4><ol>
<li><p>员工编号最小值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">min</span>(empno) </span><br><span class="line"><span class="keyword">FROM</span> emp</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询工资最低的</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MIN</span>(sal)</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询年薪最低的</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * ,<span class="keyword">MIN</span>((NVL2(comm,comm+sal,comm)*<span class="number">12</span> )</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="2-7-、注意事项"><a href="#2-7-、注意事项" class="headerlink" title="2.7 、注意事项"></a>2.7 、注意事项</h3><ol>
<li>分组函数只能出现在select 列、having、order by子句中(不能出现在where后面)</li>
<li>当使用分组函数时，除了函数count(*)外，其他分组函数都会忽略NULL行。</li>
</ol>
<h3 id="2-8、单行函数和聚合函数的区别"><a href="#2-8、单行函数和聚合函数的区别" class="headerlink" title="2.8、单行函数和聚合函数的区别"></a>2.8、单行函数和聚合函数的区别</h3><ol>
<li>单行函数操作时，根据函数的功能同时处理一行数据，返回每一行的处理结果；</li>
<li>聚合函数同时对分组后的一组行进行操作，返回分组后各组的处理结果</li>
</ol>
<h2 id="四、分组统计查询"><a href="#四、分组统计查询" class="headerlink" title="四、分组统计查询"></a>四、分组统计查询</h2><h3 id="1、概要"><a href="#1、概要" class="headerlink" title="1、概要"></a>1、概要</h3><blockquote>
<p>Group By语句从英文的字面意义上理解就是“根据(by)一定的规则进行分组(Group)”。它的作用是通过一定的规则将一个数据集划分成若干个小的区域，然后针对若干个小区域进行数据处理。 如果在查询的过程中需要按某一列的值进行分组,以统计该组内数据的信息时,就要使用group by子句。不管select是否使用了where子句都可以使用group by子句group by子句一定要与分组函数结合使用,否则没有意义。</p>
</blockquote>
<h3 id="2、语法格式"><a href="#2、语法格式" class="headerlink" title="2、语法格式"></a>2、语法格式</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt; ----语句------------------------------------------------------------执行顺序-----</span><br><span class="line">&gt; </span><br><span class="line">&gt; SELECT [DISTINCT] * | 列名称 [别名] , 列名称 [别名] ,... | 统计函数   4、确定查询列</span><br><span class="line">&gt; </span><br><span class="line">&gt; FROM 数据表 [别名] , 数据表 [别名] ,...                              1、数据来源</span><br><span class="line">&gt; </span><br><span class="line">&gt; [WHERE 条件(s)]                                                     2、过滤数据行</span><br><span class="line">&gt; </span><br><span class="line">&gt; [GROUP BY 分组字段, 分组字段, ...]                                   3、执行分组操作</span><br><span class="line">&gt; </span><br><span class="line">&gt; [ORDER BY 字段 [ASC | DESC] , 字段 [ASC | DESC] ,...]               5、数据排序</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
</blockquote>
<h3 id="3、示例代码"><a href="#3、示例代码" class="headerlink" title="3、示例代码"></a>3、示例代码</h3><ol>
<li><p>查询每个部门的人数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> deptno ,<span class="keyword">COUNT</span>(*)</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno;</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示每个部门员工的平均工资</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> deptno ,<span class="keyword">AVG</span>(sal) 平均工资 </span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno;</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示各个部门员工的工资+奖金</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> deptno,<span class="keyword">SUM</span>(sal + NVL(comm,<span class="number">0</span>))</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno;</span><br></pre></td></tr></table></figure>
</li>
<li><p>按照部门编号分组，求出每个部门的人数，平均工资(要求截取2位)(配合单行函数使用)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> deptno, <span class="keyword">COUNT</span>(empno), <span class="keyword">ROUND</span>(<span class="keyword">AVG</span>(sal),<span class="number">2</span>) </span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno;</span><br></pre></td></tr></table></figure>
</li>
<li><p>按照职位分组，求出每个职位的最高和最低工资(单字段分组)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> job, <span class="keyword">MAX</span>(sal), <span class="keyword">MIN</span>(sal)</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询每个部门的每种岗位的平均工资和最低工资</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">AVG</span>(sal), <span class="keyword">MIN</span>(sal)</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno;</span><br></pre></td></tr></table></figure>
</li>
<li><p>先统计出各个职位(job)的平均工资(AVG),再统计平均工资最高的工资(分组函数嵌套)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MAX</span>(<span class="keyword">AVG</span>(sal))</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job</span><br><span class="line">注意:分组函数允许嵌套，但是嵌套之后的分组函数的查询之中不能再出现任何的其他字段</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询每个岗位的总工资但不包括’SALESMAN’岗位(配合Where使用)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">name</span> !=<span class="string">'SALESMAN'</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>按部门、不同的职位，统计员工的工资总额 (多字段统计)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> deptno, job, <span class="keyword">sum</span>(sal)</span><br><span class="line"><span class="keyword">FROM</span> emp   </span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno, job;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询各个部门中相同职位的员工人数并且按部门编号排序(多字段统计排序)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DEPTNO, JOB,<span class="keyword">COUNT</span>(*) </span><br><span class="line"><span class="keyword">FROM</span>  emp</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno,job  </span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> deptno;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询出每个部门的名称、部门的人数、平均工资(多表单字段查询)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1、确定表</span><br><span class="line">    dept表</span><br><span class="line">    emp表</span><br><span class="line">2、确定关联字段</span><br><span class="line">    deptno</span><br><span class="line">3. 查询</span><br><span class="line">  <span class="keyword">SELECT</span> dname,<span class="keyword">count</span>(e.empno),<span class="keyword">AVG</span>(sal)</span><br><span class="line">  <span class="keyword">FROM</span> emp e,dept d</span><br><span class="line">  <span class="keyword">WHERE</span>  e.deptno(+) = d.deptno</span><br><span class="line">  <span class="keyword">group</span> <span class="keyword">by</span> dname;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="4、注意事项"><a href="#4、注意事项" class="headerlink" title="4、注意事项"></a>4、注意事项</h3><ol>
<li><p>GROUP BY后不可以接列的别名（根据执行顺序分析就知道了）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>  deptno dn ,<span class="keyword">AVG</span>(sal)</span><br><span class="line"><span class="keyword">FROM</span> emp  </span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> dn;  <span class="comment">--错误</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>GROUP BY 后不能接数字</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>  deptno dn ,<span class="keyword">AVG</span>(sal)</span><br><span class="line"><span class="keyword">FROM</span> emp  </span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="number">1</span>;   <span class="comment">--错误</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>GROUP BY 后可以接select后没有的列名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>  deptno dn ,<span class="keyword">AVG</span>(sal) </span><br><span class="line"><span class="keyword">FROM</span> emp  </span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job;</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果一个SELECT中使用了分组函数，任何不在分组函数中的列(表达式)必须要在GROUP BY中</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>  job ,deptno dn ,<span class="keyword">AVG</span>(sal) <span class="comment">--deptno列group by 后面没有，使用会报错</span></span><br><span class="line"><span class="keyword">FROM</span> emp  </span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>笔记：3和4总结为一句话</p>
<p>1、在select中出现的列名必须在group by 中出现，否则，其他列名只能在分组函数中使用;而在group by 中出现的字段不一定要在select中出现</p>
</blockquote>
</li>
<li><p>group by之前可以使用where过滤数据,因为where是在分组之前起作用的，(执行顺序分析)     —-废话</p>
</li>
</ol>
<h3 id="5、使用HAVING过滤分组"><a href="#5、使用HAVING过滤分组" class="headerlink" title="5、使用HAVING过滤分组"></a>5、使用HAVING过滤分组</h3><h4 id="1、说明"><a href="#1、说明" class="headerlink" title="1、说明"></a>1、说明</h4><ol>
<li><p>首先对数据行进行分组。</p>
</li>
<li><p>把所得到的分组应用到分组函数中。</p>
</li>
<li><p>最后显示满足having条件的记录</p>
<blockquote>
<p>作用：在分组之后再过滤掉不符合条件的分组</p>
</blockquote>
</li>
</ol>
<h4 id="2、与where的区别"><a href="#2、与where的区别" class="headerlink" title="2、与where的区别"></a>2、与where的区别</h4><p>​    1.只有having里面可以使用分组函数，where中不允许出现分组函数</p>
<p>​    2.相同作用——都是根据条件过滤数据；不同的是where是在分组之前过滤数据，having是分组之后过滤分组数据。</p>
<p>​    3.原则：能在where里过滤的数据就不要在having里面去过滤</p>
<h4 id="3、语法格式"><a href="#3、语法格式" class="headerlink" title="3、语法格式"></a>3、语法格式</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt; ----语句-----------------------------------------------------------执行顺序---------</span><br><span class="line">&gt; </span><br><span class="line">&gt; SELECT [DISTINCT] * | 列名称 [别名] , 列名称 [别名] ,... | 统计函数   5、确定查询列</span><br><span class="line">&gt; </span><br><span class="line">&gt; FROM 数据表 [别名] , 数据表 [别名] ,...                              1、数据来源</span><br><span class="line">&gt; </span><br><span class="line">&gt; [WHERE 条件(s)]                                                     2、过滤数据行</span><br><span class="line">&gt; </span><br><span class="line">&gt; [GROUP BY 分组字段, 分组字段, ...]    [HIAVING 过滤分组]              3、执行分组操作</span><br><span class="line">&gt; </span><br><span class="line">&gt; [HAVING 条件(s)]                                                    4、过滤分组数据</span><br><span class="line">&gt; </span><br><span class="line">&gt; [ORDER BY 字段 [ASC | DESC] , 字段 [ASC | DESC] ,...]               6、数据排序</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="4、示例代码"><a href="#4、示例代码" class="headerlink" title="4、示例代码"></a>4、示例代码</h4><ol>
<li><p>查询部门的员工人数大于五部门编号</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> deptno,<span class="keyword">COUNT</span>(*)</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno </span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(*)&gt; <span class="number">5</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询部门工资总和大于10000的部门编号</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> deptno, <span class="keyword">SUM</span>(sal) </span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno </span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">SUM</span>(sal)&gt;<span class="number">10000</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询平均工资低于2000的部门号和它的平均工资</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> deptno,<span class="keyword">AVG</span>(sal) a</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno </span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">avg</span>(sal)&gt;<span class="number">2000</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询每个岗位的总工资并且不包括职位是’SALESMAN’岗位而且工资和大于5000</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">SUM</span>(sal)</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> job!=<span class="string">'SALESMAN'</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job  <span class="keyword">HAVING</span> <span class="keyword">SUM</span>(sal)&gt;<span class="number">5000</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="6、综合示例"><a href="#6、综合示例" class="headerlink" title="6、综合示例"></a>6、综合示例</h3><ol>
<li><p>查询非销售人员工作名称以及从事同一工作雇员的月工资的总和，并且要满足从事同一工作的雇员的月工资合计大于$5000，输出结果按月工资的合计升序排列</p>
<p>1、查询出所有的非销售人员的信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM emp WHERE job!=SALESMAN&apos;;</span><br></pre></td></tr></table></figure>
<p>2、按照职位进行分组，并且使用SUM函数统计</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT job,SUM(sal)</span><br><span class="line">FROM emp</span><br><span class="line">WHERE job&lt;&gt;&apos;SALESMAN&apos;</span><br><span class="line">GROUP BY job;</span><br></pre></td></tr></table></figure>
<p>3、月工资的合计是通过统计函数查询的，所以现在这个对分组后的过滤要使用HAVING子句完成</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT job,SUM(sal)</span><br><span class="line">FROM emp</span><br><span class="line">WHERE job!=&apos;SALESMAN&apos;</span><br><span class="line">GROUP BY job</span><br><span class="line">HAVING SUM(sal)&gt;5000;</span><br></pre></td></tr></table></figure>
<p>4、按照升序排列</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> job,<span class="keyword">SUM</span>(sal) <span class="keyword">sum</span></span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> job!=<span class="string">'SALESMAN'</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job</span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">SUM</span>(sal)&gt;<span class="number">5000</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">sum</span> <span class="keyword">ASC</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示部门编号不是30的，的部门详细信息（部门编号、部门名称、部门人数、部门月薪资总和），并要求 部门月工资总和大于8000，输出结果按部门月薪资的总和降序排列。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> d.deptno,d.dname,<span class="keyword">COUNT</span>(*) 人数,NVL(<span class="keyword">SUM</span>(e.sal),<span class="number">0</span>) 月总收入</span><br><span class="line"><span class="keyword">FROM</span> dept d,emp e</span><br><span class="line"><span class="keyword">WHERE</span> d.deptno=e.deptno(+) <span class="keyword">AND</span> d.deptno!=<span class="number">30</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> d.deptno,d.dname</span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">SUM</span>(e.sal) &gt;<span class="number">8000</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">SUM</span>(e.sal) <span class="keyword">DESC</span>;</span><br><span class="line">或</span><br><span class="line"><span class="keyword">select</span> deptno,d.dname ,<span class="keyword">count</span>(*) peonum,<span class="keyword">sum</span>(e.sal) s</span><br><span class="line"><span class="keyword">from</span> dept d <span class="keyword">left</span> <span class="keyword">join</span> emp e <span class="keyword">using</span>(deptno)  <span class="comment">--注意:using()中的字段在使用时不能有前缀。</span></span><br><span class="line"><span class="keyword">where</span> deptno !=<span class="number">30</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> deptno ,d.dname</span><br><span class="line"><span class="keyword">having</span> <span class="keyword">sum</span>(e.sal)&gt;<span class="number">8000</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> s <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="7、性能问题"><a href="#7、性能问题" class="headerlink" title="7、性能问题"></a>7、性能问题</h3><blockquote>
<p>能在where能过滤数据不要在having里过滤，A和B都能达到同样的目的，但是A性能相对好一些，因为A现将deptno=30的数据筛选出来，然后在将筛选的数据放入到临时表空间内进行分组；而B将全部的数据都读到临时表空间内，然后在临时表空间进行筛选数据，这样一来B就需要更大的临时表空间进行分组筛选，索引性能较差。</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/08/27/6.查询（函数）/" data-id="cjlc5t05o0009zctq62zeq5o5" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/08/27/7.查询（分页）/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          (no title)
        
      </div>
    </a>
  
  
    <a href="/2018/08/27/5.查询（排序）/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title"></div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/08/27/13.约束/">(no title)</a>
          </li>
        
          <li>
            <a href="/2018/08/27/12.数据类型/">(no title)</a>
          </li>
        
          <li>
            <a href="/2018/08/27/11.创建表/">(no title)</a>
          </li>
        
          <li>
            <a href="/2018/08/27/10.增删改/">(no title)</a>
          </li>
        
          <li>
            <a href="/2018/08/27/9.查询（子查询）/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body>
</html>