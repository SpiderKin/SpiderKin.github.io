<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-13.约束" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/27/13.约束/" class="article-date">
  <time datetime="2018-08-27T09:56:37.439Z" itemprop="datePublished">2018-08-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="约束"><a href="#约束" class="headerlink" title="约束"></a>约束</h1><h2 id="1、定义"><a href="#1、定义" class="headerlink" title="1、定义"></a>1、定义</h2><ol>
<li>约束是强加在表上的规则或条件。确保数据库满足业务规则。保证数据的完整性。</li>
<li>当对表进行DML或DDL操作时，如果此操作会造成表中的数据违反约束条件或规则的话，系统就会拒绝执行这个操作。</li>
<li>约束可以是列一级别的也可以是表级别的。</li>
<li>定义约束时没有给出约束的名字，ORACE系统将为该约束自动生成一个名字，其格式为SYS_Cn，其中n为自然数(强烈建议各位在创建表或增加约束时，给约束定义名称</li>
</ol>
<h2 id="2、作用"><a href="#2、作用" class="headerlink" title="2、作用"></a>2、作用</h2><ol>
<li>实现一些业务规则，防止无效的垃圾数据进入数据库，维护数据库的完整性(完整性指正确性与一致性)。</li>
<li>从而使数据库的开发和维护都更加容易</li>
</ol>
<h2 id="3、分类"><a href="#3、分类" class="headerlink" title="3、分类"></a>3、分类</h2><ol>
<li><p>行级约束</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">对一个数据列建立的约束，称为列级约束。列级约束既可以在列定义时声明，也可以在列定义后声明</span><br></pre></td></tr></table></figure>
</li>
<li><p>表级约束</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">对多个数据列建立的约束，称为表级约束。表级约束只能在列定义后声明</span><br></pre></td></tr></table></figure>
</li>
<li><p>注意</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1、NOT NULL约束和DEFAULT约束不存在表级约束。其余的约束都存在列级约束和表级约束。</span><br><span class="line">2、实际开发过程中，列级约束使用的较多，表级约束很少使用</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="4、约束类型"><a href="#4、约束类型" class="headerlink" title="4、约束类型"></a>4、约束类型</h2><h3 id="1、说明"><a href="#1、说明" class="headerlink" title="1、说明"></a>1、说明</h3><ol>
<li>唯一约束</li>
<li>主键约束</li>
<li>外键约束</li>
<li>检查约束</li>
<li>空值约束</li>
<li>默认值约束</li>
</ol>
<h3 id="2、主键约束-PRIMARY-KEY-Constraint"><a href="#2、主键约束-PRIMARY-KEY-Constraint" class="headerlink" title="2、主键约束(PRIMARY KEY Constraint)"></a>2、主键约束(PRIMARY KEY Constraint)</h3><h4 id="2-1、定义"><a href="#2-1、定义" class="headerlink" title="2.1、定义"></a>2.1、定义</h4><p>​     唯一的标识表中的每一行，不能重复，不能为空。 创建主键或唯一约束后，ORACLE会自动创建一个与约束同名的索引（UNIQUENES为UNIQUE唯一索引）</p>
<blockquote>
<p>笔记说明：</p>
<p>1、一个表必须有一个主键约束（通常情况一般只有一个主键），开发规则</p>
<p>2、特点：（1）不为空，唯一  （2）默认创建唯一索引</p>
</blockquote>
<h4 id="2-2、作用"><a href="#2-2、作用" class="headerlink" title="2.2、作用"></a>2.2、作用</h4><p>​ 实现表中记录的一个唯一性,一个表中一般只有一个主键(建议)</p>
<h4 id="2-3、主键分类"><a href="#2-3、主键分类" class="headerlink" title="2.3、主键分类"></a>2.3、主键分类</h4><h5 id="1、单一主键（用的最多，涉及一个表）"><a href="#1、单一主键（用的最多，涉及一个表）" class="headerlink" title="1、单一主键（用的最多，涉及一个表）"></a>1、单一主键（用的最多，涉及一个表）</h5><h5 id="2、复合主键-不建议使用"><a href="#2、复合主键-不建议使用" class="headerlink" title="2、复合主键(不建议使用)"></a>2、复合主键(不建议使用)</h5><p>​ 表的主键含有一个以上的字段组成（只涉及一个表）</p>
<h5 id="3、联合主键-多对多的情况下使用"><a href="#3、联合主键-多对多的情况下使用" class="headerlink" title="3、联合主键(多对多的情况下使用)"></a>3、联合主键(多对多的情况下使用)</h5><p>​ 多个主键联合形成一个主键组合</p>
<h4 id="2-4、语法格式"><a href="#2-4、语法格式" class="headerlink" title="2.4、语法格式"></a>2.4、语法格式</h4><ol>
<li><p>格式1</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> 表名(</span><br><span class="line">  列名 数据类型 [<span class="keyword">constraint</span> 主键名(PK_表名)] primary <span class="keyword">key</span>, </span><br><span class="line">  列名 数据类型,</span><br><span class="line">  列名 数据类型</span><br><span class="line">)</span><br><span class="line"><span class="comment">--不加主键名系统会默认给一个,主键名一般命名为《PK_表名》</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>格式2</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> 表名</span><br><span class="line">(    </span><br><span class="line">    列名 数据类型,</span><br><span class="line">    列名 数据类型,</span><br><span class="line">    列名 数据类型,</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> [主键名称(PK_表名)] PRIMARY <span class="keyword">KEY</span> (列名, 列名,...,列名n)</span><br><span class="line">);</span><br><span class="line"><span class="comment">--此时若主键含有多个列名则为复合主键，若只有一个列，则是单一主键</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="2-5、-示例代码"><a href="#2-5、-示例代码" class="headerlink" title="2.5、 示例代码"></a>2.5、 示例代码</h4><ol>
<li><p>在创建数据的时候在行的后面添加</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span>  <span class="keyword">TABLE</span> TB_USER(</span><br><span class="line">  UID <span class="built_in">NUMBER</span>(<span class="number">10</span>) <span class="keyword">CONSTRAINT</span> <span class="string">"PK_TB_USER"</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">  USERNAME VARCHAR2(<span class="number">64</span>),</span><br><span class="line">  <span class="keyword">PASSWORD</span> VARCHAR2(<span class="number">32</span>),</span><br><span class="line">  EMAIL   VARCHAR2(<span class="number">32</span>),</span><br><span class="line">  PHONE   <span class="built_in">CHAR</span>(<span class="number">11</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
<li><p>放在建表语句的后面添加</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span>  <span class="keyword">TABLE</span> TB_USER(</span><br><span class="line">    UID <span class="built_in">NUMBER</span>(<span class="number">10</span>),</span><br><span class="line">    USERNAME VARCHAR2(<span class="number">64</span>),</span><br><span class="line">    <span class="keyword">PASSWORD</span> VARCHAR2(<span class="number">32</span>),</span><br><span class="line">    EMAIL   VARCHAR2(<span class="number">32</span>),</span><br><span class="line">    PHONE   <span class="built_in">CHAR</span>(<span class="number">11</span>),</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> <span class="string">"PK_TB_USER"</span> PRIMARY <span class="keyword">KEY</span> (UID) </span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="2-6、添加方式"><a href="#2-6、添加方式" class="headerlink" title="2.6、添加方式"></a>2.6、添加方式</h4><ol>
<li>建表时添加，</li>
<li>建表后添加</li>
<li>当建立复合主键的时候必须使用表级添加</li>
</ol>
<h4 id="2-7、主键约束的限制"><a href="#2-7、主键约束的限制" class="headerlink" title="2.7、主键约束的限制"></a>2.7、主键约束的限制</h4><ol>
<li>一个表或视图一般只有一个主键</li>
<li>开发中强烈建议使用NUMBER或VARCHAR2类型</li>
<li>不能指定一列或组合列既是主键又是唯一键</li>
<li>主键大小不能超过一个数据块大小</li>
<li>主键组合键不能超过32列。</li>
<li>创建一个继承层次结构中的子视图时，你不能指定一个主键。主键可以唯一指定的顶层（根）视图</li>
</ol>
<h4 id="2-8、主键自动增长"><a href="#2-8、主键自动增长" class="headerlink" title="2.8、主键自动增长"></a>2.8、主键自动增长</h4><ol>
<li><p>建表</p>
</li>
<li><p>建立序列</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CREATE SEQUENCE dept_sequence</span><br><span class="line">increment by 1</span><br><span class="line">start with 1</span><br><span class="line">nomaxvalue</span><br><span class="line">nocycle</span><br><span class="line">nocache;</span><br></pre></td></tr></table></figure>
</li>
<li><p>建立触发器（目的是在表插入数据的时候启用序列生成的值）</p>
</li>
</ol>
<h3 id="2、外键约束-FOREIGN-KEY-Constraint"><a href="#2、外键约束-FOREIGN-KEY-Constraint" class="headerlink" title="2、外键约束(FOREIGN KEY Constraint)"></a>2、外键约束(FOREIGN KEY Constraint)</h3><h4 id="2-1-、定义"><a href="#2-1-、定义" class="headerlink" title="2.1 、定义"></a>2.1 、定义</h4><pre><code>1、用来维护从表（Child Table）和主表（Parent Table）之间的引用完整性. 
</code></pre><p>​    2、外键约束是个有争议性的约束，它一方面能够维护数据库的数据一致性，数据的完整性，防止错误的垃圾数据入库；</p>
<p>​    3、 另外一方面它会增加表插入、更新等SQL性能的额外开销，不少系统里面通过业务逻辑控制来取消外键约束</p>
<h4 id="2-2-、语法格式"><a href="#2-2-、语法格式" class="headerlink" title="2.2 、语法格式"></a>2.2 、语法格式</h4><ol>
<li><p>格式1</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> 表名</span><br><span class="line">(</span><br><span class="line">    列名 数据类型 <span class="keyword">REFERENCES</span> 父表(参照列名) [<span class="keyword">ON</span> <span class="keyword">DELETE</span> <span class="keyword">CASCADE</span>|<span class="keyword">SET</span> <span class="literal">NULL</span>], </span><br><span class="line">    ...</span><br><span class="line">)</span><br><span class="line"><span class="comment">--参照列名一般是主表的主键</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>格式2</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> 表名</span><br><span class="line">(</span><br><span class="line">    列名 数据类型 ,</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> 约束名称(FK_TABLE_NAME) FOREIGN <span class="keyword">KEY</span>(外键列名)  <span class="keyword">REFERENCES</span> 父表(参照列名) [<span class="keyword">ON</span> <span class="keyword">DELETE</span> <span class="keyword">CASCADE</span>|<span class="keyword">SET</span> <span class="literal">NULL</span>]</span><br><span class="line">)</span><br><span class="line"><span class="comment">--外键名一般命名为《FK_表名_参照列名》</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>说明</p>
<p>1、ON DELETE SET NULL子句：当主表中的一行数据被删除时，Oracle系统会自动地将所有从表中依赖于它的数据记录的外键改成空值；</p>
<p>2、ON DELETE CASCADE：当主表中的一行数据被删除时，Oracle系统会自动地将所有从表中依赖于它的数据记录删除</p>
</li>
</ol>
<h4 id="2-3-、示例代码"><a href="#2-3-、示例代码" class="headerlink" title="2.3 、示例代码"></a>2.3 、示例代码</h4><ol>
<li><p>在主键字段后添加</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span>  <span class="keyword">TABLE</span> TB_ADDRESS(</span><br><span class="line">    ADDRESS <span class="built_in">NUMBER</span>(<span class="number">10</span>),</span><br><span class="line">    USERNAME VARCHAR2(<span class="number">64</span>),</span><br><span class="line">    UID <span class="built_in">NUMBER</span>(<span class="number">12</span>)  <span class="keyword">CONSTRAINT</span> FK_TBUSER_UID <span class="keyword">REFERENCES</span> TB_USER(UID) <span class="keyword">ON</span> <span class="keyword">DELETE</span> <span class="keyword">CASCADE</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
<li><p>建表后添加</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span>  <span class="keyword">TABLE</span> TB_ADDRESS(</span><br><span class="line">    ADDRESS <span class="built_in">NUMBER</span>(<span class="number">10</span>),</span><br><span class="line">    USERNAME VARCHAR2(<span class="number">64</span>),</span><br><span class="line">    UID <span class="built_in">NUMBER</span>(<span class="number">12</span>),</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> <span class="string">"FK_TBUSER_UID"</span> FOREIGN <span class="keyword">KEY</span>(UID) <span class="keyword">REFERENCES</span> TB_USER(UID) <span class="keyword">ON</span> <span class="keyword">DELETE</span> <span class="keyword">SET</span> <span class="literal">NULL</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="2-4-、特点"><a href="#2-4-、特点" class="headerlink" title="2.4 、特点"></a>2.4 、特点</h4><blockquote>
<p>参照主键中存在的值并且可以插入重复的记录，而且可以插入重复的空值。</p>
</blockquote>
<h4 id="2-5、注意事项"><a href="#2-5、注意事项" class="headerlink" title="2.5、注意事项"></a>2.5、注意事项</h4><ol>
<li>外键字段不能为LOB, LONG, LONG RAW, VARRAY, NESTED TABLE, BFILE, REF, TIMESTAMP WITH TIME ZONE, or user-defined type类型，主键可以包含数据类型为TIMESTAMP WITH LOCAL TIME ZONE的字段</li>
<li>引用唯一或主键约束，必须是父表中已经定义的</li>
<li>外键的组合列不能超过32列</li>
<li>字表和父表必须在同一个数据库。分布式数据库中，外键不能跨节点，但触发器可以你不能在CREATE TABLE语句中包含AS子查询子句定义一个外键约束。相反，你必须创建一个没有约束的表，然后添加ALTER TABLE语句</li>
<li>参照列必须是主键或者是unique列</li>
</ol>
<h4 id="2-6、对DML与DDL的影响"><a href="#2-6、对DML与DDL的影响" class="headerlink" title="2.6、对DML与DDL的影响"></a>2.6、对DML与DDL的影响</h4><ol>
<li><p>INSERT：只有操作是在子表或从表这一端时才会产生违反引用完整性约束的问题，父表则不然。</p>
</li>
<li><p>DELETE：只有操作是在父表或主表这一端时才会产生违反引用完整性约束的问题，子表则不然。</p>
</li>
<li><p>UPDATE：子表父表直接操作都会违反引用完整性约束。两种解决方法：</p>
<p>1、先更新子表的引用列为空，再更新父表的主键的列的值，然后把子表的引用列更新成新的父表的值；</p>
<p>2、使用ON DELETE SET NULL，先更新父表，然后将子表外键为空的记录更新为新的值。</p>
</li>
<li><p>DDL语句：DROP TABLE与TRUNCATE TABLE，操作父表，违反引用完整性约束，子表则不然</p>
<blockquote>
<p>笔记说明</p>
<p>1、一般两个表如果有关联关系，就会把主表（一）的主键作为从表（多）的外键</p>
<p>2、创建从表之前必须保证主表存在，否则先创建主表。</p>
<p>3、删除表的时候先删除从表才能删除主表</p>
</blockquote>
</li>
</ol>
<h3 id="3、唯一约束-Unique-Constraint"><a href="#3、唯一约束-Unique-Constraint" class="headerlink" title="3、唯一约束(Unique Constraint)"></a>3、唯一约束(Unique Constraint)</h3><h4 id="3-1、定义"><a href="#3-1、定义" class="headerlink" title="3.1、定义"></a>3.1、定义</h4><pre><code>1、唯一性约束指的是表中一个或者多个字段联合起来能够唯一标识一条记录的约束,
</code></pre><p>​    2、联合自段中可以包含空值且联合字段不能超过32个</p>
<h4 id="3-2、作用"><a href="#3-2、作用" class="headerlink" title="3.2、作用"></a>3.2、作用</h4><blockquote>
<p>因为表中只有一个主键，但是其他的列需要唯一要求</p>
</blockquote>
<h4 id="3-3、特点"><a href="#3-3、特点" class="headerlink" title="3.3、特点"></a>3.3、特点</h4><pre><code>1、当唯一约束指的是一个字段时，可以插入null，但是只能插入一次；
</code></pre><p>​    2、当唯一约束指的是联合字段时，可以插入null，且字段可以插入重复的空值（参照下面笔记说明）</p>
<blockquote>
<p>笔记说明：</p>
<p>当唯一约束指的是联合字段时，只要其中一个列不同则代表这一组列是唯一的，即可以让其他列相同，但至少一个列不同</p>
</blockquote>
<h4 id="3-4、语法格式"><a href="#3-4、语法格式" class="headerlink" title="3.4、语法格式"></a>3.4、语法格式</h4><ol>
<li><p>格式1</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> 表名</span><br><span class="line">(</span><br><span class="line">    列名 数据类型,</span><br><span class="line">    列名 数据类型,</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> [唯一约束名(UK_表名_列名)] <span class="keyword">UNIQUE</span> (列名)</span><br><span class="line">  <span class="comment">--CONSTRAINT [唯一约束名(UK_表名_列名)] UNIQUE (列名, 列名,...)</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="3-5、示例代码"><a href="#3-5、示例代码" class="headerlink" title="3.5、示例代码"></a>3.5、示例代码</h4><ol>
<li><p>单列添加唯一性约束</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TB_UNIQUE</span><br><span class="line">(</span><br><span class="line">  U_ID <span class="built_in">NUMBER</span>(<span class="number">10</span>),</span><br><span class="line">  USERNAME  VARCHAR2(<span class="number">32</span>),</span><br><span class="line">  PHONE VARCHAR2(<span class="number">11</span>)</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> UK_TBUNIQUE_UID  <span class="keyword">UNIQUE</span> (USERNAME)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
<li><p>多列添加唯一约束</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TB_UNIQUE</span><br><span class="line">(</span><br><span class="line">    U_ID <span class="built_in">NUMBER</span>(<span class="number">10</span>),</span><br><span class="line">    USERNAME  VARCHAR2(<span class="number">32</span>),</span><br><span class="line">    PHONE VARCHAR2(<span class="number">11</span>)</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> UK_TBUNIQUE_UID  <span class="keyword">UNIQUE</span> (USERNAME,PHONE)</span><br><span class="line">);</span><br><span class="line"><span class="comment">--说明：(USERNAME,PHONE)</span></span><br><span class="line"><span class="comment">--		('xiaoming','110')</span></span><br><span class="line"><span class="comment">--		('xiaoming','120')</span></span><br><span class="line"><span class="comment">--这两个组合值其中有一个列的值不相同，所以这个联合字段的两组值都是唯一的。只有两个列的值都相同时，这两个组合值才是相同的，不符合唯一约束。</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="3-6、与主键的区别"><a href="#3-6、与主键的区别" class="headerlink" title="3.6、与主键的区别"></a>3.6、与主键的区别</h4><ol>
<li>唯一性约束所在的列允许空值，但是主键约束所在的列不允许空值。</li>
<li>可以把唯一性约束放在一个或者多个列上，这些列或列的组合必须有唯一的。但是，唯一性约束所在的列并不是表的主键列。</li>
<li>唯一性约束强制在指定的列上创建一个唯一性索引。在默认情况下，创建唯一性的非聚簇索引，但是，也可以指定所创建的索引是聚簇索引。</li>
<li>建立主键的目的是让外键来引用.</li>
<li>一个表一般最多只有一个主键，但可以有很多唯一键</li>
</ol>
<h3 id="4、检查约束-Check-Constraint"><a href="#4、检查约束-Check-Constraint" class="headerlink" title="4、检查约束(Check Constraint)"></a>4、检查约束(Check Constraint)</h3><h4 id="4-1-定义"><a href="#4-1-定义" class="headerlink" title="4.1 定义"></a>4.1 定义</h4><p>​ 根据用户自己的需求来进行限制</p>
<h4 id="4-2-语法格式"><a href="#4-2-语法格式" class="headerlink" title="4.2 语法格式"></a>4.2 语法格式</h4><ol>
<li><p>格式1</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TB_CHECK</span><br><span class="line">(</span><br><span class="line">    列名 数据类型   [<span class="keyword">CONSTRAINT</span> 检查约束名(CK_表名_列名)] <span class="keyword">CHECK</span> [<span class="keyword">NOT</span> <span class="keyword">FOR</span> <span class="keyword">REPLICATION</span>],</span><br><span class="line">    列名 数据类型,</span><br><span class="line">    ...</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
<li><p>格式2</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TB_CHECK</span><br><span class="line">(</span><br><span class="line">    列名 数据类型,</span><br><span class="line">    列名 数据类型,</span><br><span class="line">    [<span class="keyword">CONSTRAINT</span> 检查约束名(CK_表名_列名)] <span class="keyword">CHECK</span>(列名) [<span class="keyword">NOT</span> <span class="keyword">FOR</span> <span class="keyword">REPLICATION</span>]</span><br><span class="line">);</span><br><span class="line"><span class="comment">--NOT FOR REPLICATION:指定检查约束(注意在把从其它表中复制的数据插入到表中时不发生作用)</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="4-3-示例代码"><a href="#4-3-示例代码" class="headerlink" title="4.3 示例代码"></a>4.3 示例代码</h4><ol>
<li><p>在行级别添加</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TB_CHECK</span><br><span class="line">(</span><br><span class="line">  USERNAME VARCHAR2(<span class="number">32</span>),</span><br><span class="line">  PHONE  VARCHAR2(<span class="number">11</span>) <span class="keyword">CHECK</span>(<span class="keyword">LENGTH</span>(PHONE) =<span class="number">11</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
<li><p>约束放在表后</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TB_CHECK1</span><br><span class="line">(</span><br><span class="line">    USERNAME VARCHAR2(<span class="number">32</span>),</span><br><span class="line">    PHONE  VARCHAR2(<span class="number">11</span>),</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> CK_TBCHECK_PHONE <span class="keyword">CHECK</span>(<span class="keyword">LENGTH</span>(PHONE)=<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">FOR</span> <span class="keyword">REPLICATION</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="5、空值约束-Not-Null-Constraint"><a href="#5、空值约束-Not-Null-Constraint" class="headerlink" title="5、空值约束(Not Null Constraint)"></a>5、空值约束(Not Null Constraint)</h3><h4 id="5-1、说明"><a href="#5-1、说明" class="headerlink" title="5.1、说明"></a>5.1、说明</h4><ol>
<li>一种是限制为null(意义不大)，一般是将值限制为Not Null</li>
<li>NOT NULL只能在列级定义</li>
</ol>
<h4 id="5-2、作用："><a href="#5-2、作用：" class="headerlink" title="5.2、作用："></a>5.2、作用：</h4><p>​ 使指定的列必须插入值</p>
<h4 id="5-3、语法格式"><a href="#5-3、语法格式" class="headerlink" title="5.3、语法格式"></a>5.3、语法格式</h4><ol>
<li><p>格式</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> 表名</span><br><span class="line">(</span><br><span class="line">    列名 数据类型 <span class="literal">null</span>/<span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">    ...</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="5-4、示例代码"><a href="#5-4、示例代码" class="headerlink" title="5.4、示例代码"></a>5.4、示例代码</h4><ol>
<li><p>不允许为null</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE TB_NULL</span><br><span class="line">(</span><br><span class="line">    USER_ID NUMBER(10) PRIMARY KEY,</span><br><span class="line">    USERNAME VARCHAR2(64) NOT NULL</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="6、默认约束-Default-Counstraint"><a href="#6、默认约束-Default-Counstraint" class="headerlink" title="6、默认约束(Default Counstraint)"></a>6、默认约束(Default Counstraint)</h3><h4 id="6-1、定义"><a href="#6-1、定义" class="headerlink" title="6.1、定义"></a>6.1、定义</h4><ol>
<li>当不插入值的时候给默认效果</li>
<li>用的使modify 来进行修改</li>
</ol>
<h4 id="6-2、语法格式"><a href="#6-2、语法格式" class="headerlink" title="6.2、语法格式"></a>6.2、语法格式</h4><ol>
<li><p>格式</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DEFAULT 默认值</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="6-3、示例代码"><a href="#6-3、示例代码" class="headerlink" title="6.3、示例代码"></a>6.3、示例代码</h4><ol>
<li><p>给列添加默认值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TB_DEFAULT(</span><br><span class="line">    USER_ID  <span class="built_in">NUMBER</span>(<span class="number">10</span>) PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">    USERNAME  VARCHAR2(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    PHONE    VARCHAR2(<span class="number">11</span>) <span class="keyword">CHECK</span>(<span class="keyword">LENGTH</span>(PHONE) =<span class="number">11</span>),</span><br><span class="line">    SEX   <span class="built_in">NUMBER</span>(<span class="number">2</span>)  DEFALUT <span class="number">0</span>,</span><br><span class="line">    CREATE_TIME  <span class="built_in">DATE</span> DEFALUT  <span class="keyword">SYSDATE</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="7-、其他"><a href="#7-、其他" class="headerlink" title="7 、其他"></a>7 、其他</h3><h4 id="7-1、约束名的命名规则"><a href="#7-1、约束名的命名规则" class="headerlink" title="7.1、约束名的命名规则"></a>7.1、约束名的命名规则</h4><ol>
<li>主键约束: PK_表名</li>
<li>唯一约束: UK <em>表名 </em>列名</li>
<li>外键约束: FK<em> 表名</em> 列名</li>
<li>条件约束 :CK<em> 表名</em>列名</li>
</ol>
<h4 id="7-2、注意事项"><a href="#7-2、注意事项" class="headerlink" title="7.2、注意事项"></a>7.2、注意事项</h4><ol>
<li>NOT NULL约束和DEFAULT约束只能被创建为列级约束</li>
<li>其他４种则既可以被创建为列级约束，也可以被创建为表级约束</li>
<li>当一个约束涉及到多列时，只能被创建成表级约束</li>
<li>可以为其他4种约束起名，而不能给NOT NULL和DEFAULT约束起名</li>
</ol>
<h4 id="7-3、约束管理"><a href="#7-3、约束管理" class="headerlink" title="7.3、约束管理"></a>7.3、约束管理</h4><ol>
<li><p>删除约束</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名  <span class="keyword">DROP</span> <span class="keyword">CONSTRAINT</span> 列名; </span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名  <span class="keyword">DROP</span> PRIMARY <span class="keyword">KEY</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名  <span class="keyword">DROP</span> PRIMARY <span class="keyword">KEY</span> <span class="keyword">CASCADE</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>启用约束</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 <span class="keyword">ENABLE</span> <span class="keyword">CONSTRAINT</span> 列名; </span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 <span class="keyword">ENABLE</span> PRIMARY <span class="keyword">KEY</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>禁用约束</p>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/08/27/13.约束/" data-id="cjlc5t05d0003zctqxqaacc1b" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-12.数据类型" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/27/12.数据类型/" class="article-date">
  <time datetime="2018-08-27T09:56:37.435Z" itemprop="datePublished">2018-08-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h1><h2 id="一、数据类型是什么？"><a href="#一、数据类型是什么？" class="headerlink" title="一、数据类型是什么？"></a><strong>一、数据类型是什么？</strong></h2><blockquote>
<p>数据类型是指列的数据特征，它决定了数据的存储格式，代表了不同的信息类型。</p>
<p>有一些数据是要存储为数字的，数字当中有些是要存储为整数、小数、日期型等…</p>
</blockquote>
<h2 id="二、MYSQL常见数据类型"><a href="#二、MYSQL常见数据类型" class="headerlink" title="二、MYSQL常见数据类型"></a>二、MYSQL常见数据类型</h2><p>　　MySQL支持多种类型，大致可以分为四类：<strong>数值型、浮点型、日期/时间和字符串(字符)类型</strong>。</p>
<h2 id="三、整型"><a href="#三、整型" class="headerlink" title="三、整型"></a>三、整型</h2><ol>
<li><p>常用</p>
<p>| 数据类型 | 字节数 | 最小值               | 最大值              |<br>| ——– | —— | ——————– | ——————- |<br>| TINYINT  | 1      | -128                 | 127                 |<br>| INT      | 4      | -2147483648          | 2147483647          |<br>| BIGINT   | 8      | -9223372036854775808 | 9223372036854775807 |</p>
</li>
<li><p>语法格式</p>
<p>整型<a href="N"></a></p>
</li>
<li><p>说明</p>
<ul>
<li>无论N等于多少，int永远占4个字节</li>
<li>N表示的是显示宽度，</li>
<li>N可以省略不写,默认是11位</li>
</ul>
</li>
<li><p>示例代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">create table test1 (</span><br><span class="line">    a int,</span><br><span class="line">    b int(11) ,</span><br><span class="line">    c int(10) ,</span><br><span class="line">    d int(255)</span><br><span class="line">) </span><br><span class="line"></span><br><span class="line">insert into test_int_width values(1, 1, 1, 1111111111);</span><br><span class="line">select * from test1;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="四、浮点型"><a href="#四、浮点型" class="headerlink" title="四、浮点型"></a>四、浮点型</h2><ol>
<li><p>说明</p>
<p>MySQL中浮点型常用的有三种，分别为float、double、Decimal，可以指定浮点数和定点数的精度</p>
</li>
<li><p>常用</p>
<p>| <strong>数据类型</strong> | <strong>字节数</strong> | <strong>备注</strong>     | 范围                                   |<br>| ———— | ———- | ———— | ————————————– |<br>| float        | 4          | 单精度浮点型 | 最小非零值：±1.175494351E – 38         |<br>| double       | 8          | 双精度浮点型 | 最小非零值：±2.2250738585072014E – 308 |<br>| Decimal      | 8          | 定点数的精度 | 可变；其值的范围依赖于M 和D            |</p>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">浮点类型[(M,D)]</span><br></pre></td></tr></table></figure>
</li>
<li><p>参数说明</p>
<ul>
<li>M表示总长度，</li>
<li>D表示小数部分长度，</li>
<li>所以整数部分长度为M-D</li>
<li>当我们不指定M、D的时候，会按照实际的精度来处理。</li>
</ul>
</li>
<li><p>区别</p>
<ul>
<li>当不指定精度时，Float、Double默认会保存实际精度，而Decimal默认是整数；</li>
<li>当标度不够时，都会四舍五入，但Decimal会警告信息。</li>
</ul>
</li>
<li><p>总结</p>
<p>1、浮点数存在误差问题(精度丢失问题)； </p>
<p>2、对货币等对精度敏感的数据，应该用定点数表示或存储；</p>
<p>3、编程中，如果用到浮点数，要特别注意误差问题，并尽量避免做浮点数比较；</p>
</li>
<li><p>示例代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE test(</span><br><span class="line">    f FLOAT(5,2) DEFAULT NULL,</span><br><span class="line">    d DOUBLE(5,2) DEFAULT NULL,</span><br><span class="line">    de DECIMAL(5,2) DEFAULT NULL</span><br><span class="line">) engine=innodb charset=utf8;</span><br><span class="line">INSERT INTO test(f,d,de) VALUES(1.23,1.23,1.23);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="五、字符串"><a href="#五、字符串" class="headerlink" title="五、字符串"></a>五、字符串</h2><ol>
<li><p>表格</p>
<p>| 类型    | 大小         | 用途       | 说明                                                |<br>| ——- | ———— | ———- | ————————————————— |<br>| CHAR    | 0-255字节    | 定长字符串 | 编码方式有关                                        |<br>| VARCHAR | 0-65535 字节 | 变长字符串 | 编码方式有关                                        |<br>| TEXT    | 0-64kb       | 长文本数据 | M&gt;500，通常会使用文本字符串,varchar也会自动转为text |</p>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">字符串类型(M)</span><br></pre></td></tr></table></figure>
</li>
<li><p>参数说明</p>
<ul>
<li>m表示字符串长度,必填</li>
<li>text 不能指定长度</li>
</ul>
</li>
<li><p>示例代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE articles (</span><br><span class="line">    title VARCHAR(255),</span><br><span class="line">    desc TEXT</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
<li><p>char和varchar：</p>
<ul>
<li>char(n) 若存入字符数小于n，则以空格补于其后，查询之时再将空格去掉。所以char类型存储的字符串末尾不能有空格，varchar不限于此。 </li>
<li>char(n) 固定长度，char(4)不管是存入几个字符，都将占用4个字节，varchar是存入的实际字符数+1个字节（n&lt;=255）或2个字节(n&gt;255)，所以varchar(4),存入3个字符将占用4个字节。</li>
<li>char类型的字符串检索速度要比varchar类型的快。 </li>
</ul>
</li>
<li><p>varchar和text： </p>
<ul>
<li>varchar可指定n，text不能指定，内部存储varchar是存入的实际字符数+1个字节（n&lt;=255）或2个字节(n&gt;255)，text是实际字符数+2个字节。 </li>
<li>text类型不能有默认值。 </li>
<li>varchar可直接创建索引，text创建索引要指定前多少个字符。varchar查询速度快于text,在都创建索引的情况下，text的索引似乎不起作用。</li>
</ul>
</li>
</ol>
<h2 id="六、日期时间"><a href="#六、日期时间" class="headerlink" title="六、日期时间"></a>六、日期时间</h2><ol>
<li><p>常用</p>
<p>| 数据类型  | 字节数 | 格式                | 备注                      |<br>| ——— | —— | ——————- | ————————- |<br>| date      | 3      | yyyy-MM-dd          | 存储日期值                |<br>| time      | 3      | HH:mm:ss            | 存储时分秒                |<br>| year      | 1      | yyyy                | 存储年                    |<br>| datetime  | 8      | yyyy-MM-dd HH:mm:ss | 存储日期+时间             |<br>| timestamp | 4      | yyyy-MM-dd HH:mm:ss | 存储日期+时间，可作时间戳 |</p>
</li>
<li><p>语法格式</p>
<p>日期时间</p>
</li>
<li><p>示例代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">create table test_time (</span><br><span class="line">    date_value date,</span><br><span class="line">    time_value time,</span><br><span class="line">    year_value year,</span><br><span class="line">    datetime_value datetime,</span><br><span class="line">    timestamp_value timestamp</span><br><span class="line">) engine=innodb charset=utf8;</span><br><span class="line"></span><br><span class="line">insert into test_time values(now(), now(), now(), now(), now());</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/08/27/12.数据类型/" data-id="cjlc5t05b0002zctqljedm03n" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-11.创建表" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/27/11.创建表/" class="article-date">
  <time datetime="2018-08-27T09:56:37.434Z" itemprop="datePublished">2018-08-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/08/27/11.创建表/" data-id="cjlc5t04e0000zctq229ged0m" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-10.增删改" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/27/10.增删改/" class="article-date">
  <time datetime="2018-08-27T09:56:37.431Z" itemprop="datePublished">2018-08-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="DML-增、删、改-操作"><a href="#DML-增、删、改-操作" class="headerlink" title="DML-增、删、改 操作"></a>DML-增、删、改 操作</h1><h2 id="一、添加（插入）"><a href="#一、添加（插入）" class="headerlink" title="一、添加（插入）"></a>一、添加（插入）</h2><h2 id="1、作用"><a href="#1、作用" class="headerlink" title="1、作用"></a>1、作用</h2><ol>
<li>为表插入单行数据</li>
<li>也可以通过子查询将一张表的多行数据插入到另外一张表里面</li>
<li>同时为多张表插入数据</li>
</ol>
<h2 id="2、基础插入数据"><a href="#2、基础插入数据" class="headerlink" title="2、基础插入数据"></a>2、基础插入数据</h2><h3 id="2-1、语法格式"><a href="#2-1、语法格式" class="headerlink" title="2.1、语法格式"></a>2.1、语法格式</h3><ol>
<li><p>格式一</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO 表 [(列名,列名,列名,...)] </span><br><span class="line">VALUES (值,值,值,...)</span><br></pre></td></tr></table></figure>
</li>
<li><p>格式二</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO 表 VALUES (值,值,值,...)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="2-2、示例代码"><a href="#2-2、示例代码" class="headerlink" title="2.2、示例代码"></a>2.2、示例代码</h3><ol>
<li><p>dept 表中插入 dept 表中 deptno=100 的数据(了解)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> dept <span class="keyword">select</span> * <span class="keyword">from</span> dept <span class="keyword">where</span> deptno=<span class="number">100</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>往 emp 表中插入 empno,ename,sal 数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp(empno,ename,sal) <span class="keyword">values</span>(<span class="number">111</span>,<span class="string">'1'</span>,<span class="number">1000.00</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp(empno,ename,sal) <span class="keyword">values</span>(<span class="number">222</span>,<span class="string">'2'</span>,<span class="number">2000.00</span>);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="2-3、说明"><a href="#2-3、说明" class="headerlink" title="2.3、说明"></a>2.3、说明</h3><ol>
<li><p>添加数字：直接编写数字111，</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp(empno,ename,sal) <span class="keyword">values</span>(<span class="number">111</span>,<span class="string">'1'</span>,<span class="number">1000</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加字符串：字符串应该使用单引号’’声明</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp(ename) <span class="keyword">values</span>(<span class="string">'苍井空'</span>);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="3、批量插入"><a href="#3、批量插入" class="headerlink" title="3、批量插入"></a>3、批量插入</h2><h3 id="3-1、语法格式"><a href="#3-1、语法格式" class="headerlink" title="3.1、语法格式"></a>3.1、语法格式</h3><ol>
<li><p>往一个表中插入多条记录</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> 表名 (列名<span class="number">1</span>, 列名<span class="number">2</span>, 列名<span class="number">3</span>)  </span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">'VALUE1'</span>, <span class="string">'VALUE2'</span>, <span class="string">'VALUE3'</span>) </span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">'VALUE1'</span>, <span class="string">'VALUE2'</span>, <span class="string">'VALUE3'</span>) </span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">'VALUE1'</span>, <span class="string">'VALUE2'</span>, <span class="string">'VALUE3'</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>插入多个值到多个表中</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> ALL </span><br><span class="line"><span class="keyword">INTO</span> 表<span class="number">1</span> (列名<span class="number">1</span>, 列名<span class="number">2</span>, 列名<span class="number">3</span>)  <span class="keyword">VALUES</span> (<span class="string">'VALUE1'</span>, <span class="string">'VALUE2'</span>, <span class="string">'VALUE3'</span>) </span><br><span class="line"><span class="keyword">INTO</span> 表<span class="number">1</span> (列名<span class="number">1</span>, 列名<span class="number">2</span>, 列名<span class="number">3</span>)  <span class="keyword">VALUES</span> (<span class="string">'VALUE1'</span>, <span class="string">'VALUE2'</span>, <span class="string">'VALUE3'</span>) </span><br><span class="line"><span class="keyword">INTO</span> 表<span class="number">1</span> (列名<span class="number">1</span>, 列名<span class="number">2</span>, 列名<span class="number">3</span>)  <span class="keyword">VALUES</span> (<span class="string">'VALUE1'</span>, <span class="string">'VALUE2'</span>, <span class="string">'VALUE3'</span>) </span><br><span class="line"><span class="keyword">INTO</span> 表<span class="number">2</span> (列名<span class="number">1</span>, 列名<span class="number">2</span>, 列名<span class="number">3</span>)  <span class="keyword">VALUES</span> (<span class="string">'VALUE1'</span>, <span class="string">'VALUE2'</span>, <span class="string">'VALUE3'</span>) </span><br><span class="line"><span class="keyword">INTO</span> 表<span class="number">2</span> (列名<span class="number">1</span>, 列名<span class="number">2</span>, 列名<span class="number">3</span>) <span class="keyword">VALUES</span> (<span class="string">'VALUE1'</span>, <span class="string">''</span>VALUE2<span class="string">', '</span>VALUE3<span class="string">') </span></span><br><span class="line"><span class="string">SELECT * FROM dual;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="3-2、示例代码"><a href="#3-2、示例代码" class="headerlink" title="3.2、示例代码"></a>3.2、示例代码</h3><ol>
<li><p>往emp表中批量插入数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> ALL </span><br><span class="line"><span class="keyword">INTO</span> emp (EMPNO, ENAME, JOB,SAL)  <span class="keyword">VALUES</span> (<span class="number">1234</span>, <span class="string">'test1'</span>,<span class="string">'IT'</span>, <span class="number">2850.12</span>)</span><br><span class="line"><span class="keyword">INTO</span> emp (EMPNO, ENAME, JOB,SAL)  <span class="keyword">VALUES</span> (<span class="number">1233</span>, <span class="string">'test2'</span>,<span class="string">'IT'</span>,  <span class="number">9200.12</span>)</span><br><span class="line"><span class="keyword">INTO</span> emp (EMPNO, ENAME, JOB,SAL)  <span class="keyword">VALUES</span> (<span class="number">1231</span>, <span class="string">'test3'</span>, <span class="string">'IT'</span>, <span class="number">9521.12</span>)</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>
</li>
<li><p>往emp,dept表中批量插入数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> ALL </span><br><span class="line"><span class="keyword">INTO</span> emp (EMPNO, ENAME, JOB,SAL,DEPTNO)  <span class="keyword">VALUES</span> (<span class="number">1234</span>, <span class="string">'test1'</span>,<span class="string">'IT'</span>, <span class="number">2850.12</span>,<span class="number">50</span>)</span><br><span class="line"><span class="keyword">INTO</span> emp (EMPNO, ENAME, JOB,SAL,DEPTNO)  <span class="keyword">VALUES</span> (<span class="number">1233</span>, <span class="string">'test2'</span>,<span class="string">'IT'</span>,  <span class="number">9200.12</span>,<span class="number">50</span>)</span><br><span class="line"><span class="keyword">INTO</span> emp (EMPNO, ENAME, JOB,SAL,DEPTNO)  <span class="keyword">VALUES</span> (<span class="number">1231</span>, <span class="string">'test3'</span>, <span class="string">'IT'</span>, <span class="number">9521.12</span>,<span class="number">50</span>)</span><br><span class="line"><span class="keyword">INTO</span> DEPT (DEPTNO,DNAME,LOC) <span class="keyword">VALUES</span>(<span class="number">50</span>,<span class="string">'IT'</span>,<span class="string">'shanghai'</span>)</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> DUAL;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="4、注意事项"><a href="#4、注意事项" class="headerlink" title="4、注意事项"></a>4、注意事项</h2><ol>
<li><p>INSERT时既可以指定列，也可以不指定列表</p>
<p>1、如果不指定列表,则values子句必须为table中的每个列提供数据,且数据顺序与列顺序相同</p>
<p>2、如果指定列表,提供的数据的顺序需与相应列对应</p>
</li>
<li><p>数字列可直接写入，字符列或日期列插入数据时必须使用单引号引住</p>
</li>
<li><p>插入数据必须满足约束规则，主键列和NOT NULL列必须提供数据值</p>
</li>
<li><p>插入的数据必须与列的个数及顺序保持一致</p>
</li>
</ol>
<h2 id="二、修改-更新"><a href="#二、修改-更新" class="headerlink" title="二、修改(更新)"></a>二、修改(更新)</h2><h3 id="1、作用-1"><a href="#1、作用-1" class="headerlink" title="1、作用"></a>1、作用</h3><p>​    对表中已有的数据行进行操作</p>
<h3 id="2、语法格式"><a href="#2、语法格式" class="headerlink" title="2、语法格式"></a>2、语法格式</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> 表名称 </span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> 更新字段<span class="number">1</span>=更新值<span class="number">1</span>,更新字段<span class="number">2</span>=更新值<span class="number">2</span>,… </span><br><span class="line"></span><br><span class="line">[<span class="keyword">WHERE</span> 更新条件(s)];</span><br></pre></td></tr></table></figure>
<h3 id="3、说明"><a href="#3、说明" class="headerlink" title="3、说明"></a>3、说明</h3><ol>
<li>编写 UPDATE 语句的时候，没有编写任何的更新条件，则表示更新表之中的全部数据，进行所有数据更新的时候，都会返回数据的更新行数，如果是增加，会显示影响的行数，同样对于删除也 会出现影响的行数。</li>
<li>在以后编写程序的时候就可以通过是否有更新行数来判断某一个更新操作是否成功</li>
</ol>
<h3 id="4、示例代码"><a href="#4、示例代码" class="headerlink" title="4、示例代码"></a>4、示例代码</h3><ol>
<li><p>把 empno=111 的员工 comm 改成 100</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE emp set comm=100 WEHER empno=111;</span><br></pre></td></tr></table></figure>
</li>
<li><p>为所有人长工资，标准是：10 部门长 10%；20 部门长 15%；30 部门长 20%其他部门长 18%（要求用 DECODE 函数）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE emp SET sal=decode(deptno,&apos;10&apos;,sal(1+0.1), &apos;20&apos;,sal(1+0.15), &apos;30&apos;,sal(1+0.2),sal(1+0.18));</span><br></pre></td></tr></table></figure>
</li>
<li><p>根据工作年限长工资，标准是：为公司工作了几个月就长几个百分点</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update emp set sal= round(sal * (1+(sysdate - hiredate)/365/12/100),2);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="5、使用子查询插入"><a href="#5、使用子查询插入" class="headerlink" title="5、使用子查询插入"></a>5、使用子查询插入</h2><ol>
<li><p>使雇员SCOTT的岗位、工资、补助与雇员SMITH的完全相同</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE emp SET (job,sal,comm)=(SELECT job,sal,comm FROM emp WHERE ename=&apos;SMITH&apos;) WHERE ename=&apos;SCOTT&apos;;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="三、删除操作"><a href="#三、删除操作" class="headerlink" title="三、删除操作"></a>三、删除操作</h2><h2 id="1、说明"><a href="#1、说明" class="headerlink" title="1、说明"></a>1、说明</h2><blockquote>
<p>没有删除条件，则删除表所有数据</p>
</blockquote>
<h2 id="2、语法格式-1"><a href="#2、语法格式-1" class="headerlink" title="2、语法格式"></a>2、语法格式</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; DELETE FROM 表名称 [WHERE 删除条件(s)];</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="3、示例代码"><a href="#3、示例代码" class="headerlink" title="3、示例代码"></a>3、示例代码</h2><ol>
<li><p>删除 empno=111 的数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">delete from emp where empno=111;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="4、注意"><a href="#4、注意" class="headerlink" title="4、注意:"></a>4、注意:</h2><ol>
<li>在开发中我们都不会使用delete删除数据,通常是假删除数据,通过设置字段来判断</li>
<li>危险操作,开发中慎用,一般都是假删除，假删除是指在表中添加一个字段（列）作为标识，然后查询时多写一个条件来去除该记录</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/08/27/10.增删改/" data-id="cjlc5t05g0004zctqkjo1daiz" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-9.查询（子查询）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/27/9.查询（子查询）/" class="article-date">
  <time datetime="2018-08-27T09:56:37.426Z" itemprop="datePublished">2018-08-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h1><h3 id="1、定义"><a href="#1、定义" class="headerlink" title="1、定义"></a>1、定义</h3><ol>
<li>指<strong>嵌入在其他sql语句中的select语句</strong></li>
<li>通俗的来讲指的是<strong>在一个查询之中嵌入若干个小的查询</strong></li>
<li>子查询可以出现在查询语句的(9i中除ORDER BY语句)任意位置上，但是实际开发运用中，子查询出现在WHERE和FROM子句之中较多。</li>
</ol>
<h3 id="2-、核心作用"><a href="#2-、核心作用" class="headerlink" title="2 、核心作用"></a>2 、核心作用</h3><blockquote>
<p>子查询的出现主要是为了<strong>解决多表查询之中的性能问题</strong>。</p>
</blockquote>
<h3 id="3-、分类"><a href="#3-、分类" class="headerlink" title="3 、分类"></a>3 、分类</h3><ol>
<li><p>嵌套查询(标准子查询)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">指子查询可以脱离主查询独立执行</span><br></pre></td></tr></table></figure>
</li>
<li><p>关联查询(相关子查询)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">关联子查询就是指子查询与主查询之间有条件关联,关联子查询会引用外部查询中的一列或多列。这种子查询之所以被称为关联子查询，是因为子查询的确与外部查询有关。当问题的答案需要依赖于外部查询中包含的每一行中的值时，通常就需要使用关联子查询。</span><br></pre></td></tr></table></figure>
</li>
</ol>
<blockquote>
<p>笔记：关联子查询（相关子查询）：子查询不可以脱离主查询独立执行</p>
</blockquote>
<h3 id="4-、FROM中使用子查询"><a href="#4-、FROM中使用子查询" class="headerlink" title="4 、FROM中使用子查询"></a>4 、FROM中使用子查询</h3><h4 id="1、说明"><a href="#1、说明" class="headerlink" title="1、说明"></a>1、说明</h4><pre><code>如果在 FROM 子句里面出现的子查询，其返回的结果一般都是多行多列数据(相当于表)。
</code></pre><h4 id="2、示例代码"><a href="#2、示例代码" class="headerlink" title="2、示例代码"></a>2、示例代码</h4><ol>
<li><p><strong>范例：</strong>查询出每个部门的编号、名称、位置、部门人数、平均工资</p>
<p>1、方式一</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> d.deptno,d.dname,d.loc,<span class="keyword">COUNT</span>(e.empno),<span class="keyword">AVG</span>(e.sal)</span><br><span class="line"><span class="keyword">FROM</span> emp e,dept d</span><br><span class="line"><span class="keyword">WHERE</span> e.deptno=d.deptno</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> d.deptno,d.dname,d.loc;</span><br></pre></td></tr></table></figure>
<p>2、方式二:通过子查询完成，所有的统计查询只能在GROUP BY中出现，所以在子查询之中负责统计数据，而在外部的查询之中，负责将统计数据和dept表数据相统一。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT d.deptno,d.dname,d.loc,temp.count,temp.avg</span><br><span class="line">FROM dept d,(SELECT deptno dno,COUNT(empno) count,AVG(sal) avg</span><br><span class="line">            FROM emp</span><br><span class="line">            GROUP BY deptno) temp</span><br><span class="line">WHERE d.deptno=temp.dno;</span><br></pre></td></tr></table></figure>
<p>3、说明</p>
<p>方式一的数据量，</p>
<p>​ 积的数量：emp 的 14 条 * dept 的 4 条 = 56 条数据；</p>
<p>方式二的数据量</p>
<ul>
<li>子查询中统计的记录是14条记录，最终统计的显示结果是3条记录；</li>
<li>dept表之中一共有4条记录；</li>
<li>如果现在产生笛卡尔积的话只有12条记录，再加上子查询中雇员的14条记录，一共才26条记录；</li>
</ul>
<p>通过如上的分析，可以发现，使用子查询的确要比使用多表查询更加节省性能，所以在开发之中子查询出现是最多的，而且在给出一个不成文的规定：大部分情况下，如果最终的查询结果之中需要出现SELECT子句，但是又不能直接使用统计函数的时候，就在子查询中统计信息，即：有复杂统计的地方大部分都需要子查询。</p>
</li>
<li><p>查询比本部门平均工资高的员工的姓名,部门编号,工资及平均工资</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> e.ename, e.sal, e.deptno, temp.salavg</span><br><span class="line"><span class="keyword">FROM</span> emp e, (<span class="keyword">SELECT</span> department_id, <span class="keyword">AVG</span>(sal) salavg</span><br><span class="line">            <span class="keyword">FROM</span> employees</span><br><span class="line">            <span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id) temp</span><br><span class="line">            <span class="keyword">WHERE</span> e.deptno = temp.deptno</span><br><span class="line"><span class="keyword">AND</span> e.sal &gt; temp.salavg</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询出部门名称，部门的员工数，部门的平均工资，部门的最低收入雇员的姓名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> d.dname,temp.cou,temp.avg,e.ename</span><br><span class="line"><span class="keyword">FROM</span> (<span class="keyword">SELECT</span> deptno,<span class="keyword">count</span>(<span class="number">1</span>) cou,<span class="keyword">round</span>(<span class="keyword">avg</span>(sal)) <span class="keyword">avg</span>,<span class="keyword">min</span>(sal) <span class="keyword">min</span></span><br><span class="line">                 <span class="keyword">FROM</span> emp    </span><br><span class="line">                 <span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno</span><br><span class="line">     ) temp,</span><br><span class="line">     dept d,</span><br><span class="line">    emp e</span><br><span class="line"><span class="keyword">WHERE</span> d.deptno=temp.deptno <span class="keyword">AND</span>  e.sal=temp.min;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>### </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/08/27/9.查询（子查询）/" data-id="cjlc5t05u000czctqtk6lo7cp" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-8.查询（多表）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/27/8.查询（多表）/" class="article-date">
  <time datetime="2018-08-27T09:56:37.421Z" itemprop="datePublished">2018-08-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="多表查询"><a href="#多表查询" class="headerlink" title="多表查询"></a>多表查询</h2><h3 id="1、定义"><a href="#1、定义" class="headerlink" title="1、定义"></a>1、定义</h3><p>​    针对多张表的查询,显示多个表的数据        </p>
<h3 id="2、语法格式"><a href="#2、语法格式" class="headerlink" title="2、语法格式"></a>2、语法格式</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; SELECT [DISTINCT] * | 列名称 [别名] , 列名称 [别名] ,...</span><br><span class="line">&gt; FROM 数据表 [别名] , 数据表 [别名] ,...</span><br><span class="line">&gt; [WHERE 条件(s)]</span><br><span class="line">&gt; [ORDER BY 字段 [ASC | DESC] , 字段 [ASC | DESC] ,...]	</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="3、笛卡尔集"><a href="#3、笛卡尔集" class="headerlink" title="3、笛卡尔集"></a>3、笛卡尔集</h3><h4 id="1、定义-1"><a href="#1、定义-1" class="headerlink" title="1、定义"></a>1、定义</h4><blockquote>
<p>笛卡尔乘积是指在数学中，两个集合X和<em>Y</em>的笛卡尓积（Cartesian product），又称直积</p>
<p>假设集合A={a, b}，集合B={0, 1, 2}，则两个集合的笛卡尔积为{(a, 0), (a, 1), (a, 2), (b, 0), (b, 1), (b, 2)}</p>
</blockquote>
<h4 id="2、案例分析"><a href="#2、案例分析" class="headerlink" title="2、案例分析"></a>2、案例分析</h4><ol>
<li><p>同时查询emp和dept表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> dept;</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> emp,dept;</span><br></pre></td></tr></table></figure>
</li>
<li><p>分析</p>
<p>发现emp14条，dept表4条。但返回了56条数据56=14*4</p>
</li>
</ol>
<h4 id="3、如何避免笛卡尔积"><a href="#3、如何避免笛卡尔积" class="headerlink" title="3、如何避免笛卡尔积"></a>3、如何避免笛卡尔积</h4><p>​    唯一的方案就是在WHERE字句中加入有效的关联字段,</p>
<ol>
<li><p>示例代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * </span><br><span class="line">FROM emp e,dept d</span><br><span class="line">WHERE  e.deptno=d.deptno;</span><br></pre></td></tr></table></figure>
<p><img src="http://opzv089nq.bkt.clouddn.com/17-7-31/46451349.jpg" alt=""></p>
</li>
<li><p>说明</p>
<p>1、从查询的结果看,我们显示的数据正常了,但仅仅是显示上去除了笛卡尔,而真正笛卡尔积现在依然存在，因为数据库的操作机制就属于逐行的进行数据的判断，那么如果按照这个思路理解的话，现在假设两张表的数据量都很大的话，那么使用这种多表查询的性能,无法从根本上解决这个问题<br>2、在进行多表查询的时候一定会存在有关联列，在开发中一般都使用表的主键作为关联表的字段,名字基本也一样.这样方便阅读和理解 </p>
<p>3、如果表之中存在有同名的列，那么一定要使用“表名称.字段名”,或者使用“别名.字段名“(推荐使用别名,开发中常用)​</p>
</li>
</ol>
<h4 id="4、示例代码"><a href="#4、示例代码" class="headerlink" title="4、示例代码"></a>4、示例代码</h4><ol>
<li><p>查询每个雇员的编号，姓名，职位，工资，部门名称，部门位置</p>
<p><strong>分析问题：</strong></p>
<ul>
<li>确定使用到的数据表<ul>
<li>emp表(编号，姓名，职位，工资)</li>
<li>dept表(部门名称，部门位置)</li>
</ul>
</li>
<li>确定已知的关联字段<ul>
<li>emp表与dept表的 deptno。 emp.deptno = dept.deptno；</li>
</ul>
</li>
</ul>
<p><strong>解决问题：</strong></p>
<ol>
<li><p>第一步：查询出每一位雇员的编号，姓名，职位，工资</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> e.empno,e.ename,e.job,e.sal</span><br><span class="line"><span class="keyword">FROM</span> emp e;</span><br></pre></td></tr></table></figure>
</li>
<li><p>第二步：为查询中引入部门表，同时需要增加一个消除笛卡尔积的条件</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> e.empno,e.ename,e.job,e.sal,d.dname,d.loc</span><br><span class="line"><span class="keyword">FROM</span> emp e,dept d</span><br><span class="line"><span class="keyword">WHERE</span> e.deptno=d.deptno;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="http://ojx4zwltq.bkt.clouddn.com/17-4-12/65349840-file_1492008989937_129b.png" alt=""></p>
</li>
<li><p>查询每个雇员的编号，姓名，职位，工资，工资等级。</p>
<p><strong>分析问题：</strong></p>
<ul>
<li>确定使用到的数据表<ul>
<li>emp表(编号，姓名，职位，工资)</li>
<li>salgrade表(工资等级)</li>
</ul>
</li>
<li>确定已知的关联字段<ul>
<li>emp 表 sal 与salgrade表的 lasal,hisal。 emp.sal BETWEEN  salgrade.losal AND salgrade.hisal；</li>
</ul>
</li>
</ul>
<p><strong>解决问题：</strong></p>
<ol>
<li><p>第一步：查询出每一位雇员的编号，姓名，职位，工资</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> e.empno,e.ename,e.job,e.sal</span><br><span class="line"><span class="keyword">FROM</span> emp e;</span><br></pre></td></tr></table></figure>
</li>
<li><p>第二步：为查询中引入工资等级表，同时需要增加一个消除笛卡尔积的条件</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> e.empno,e.ename,e.job,e.sal,s.grade</span><br><span class="line"><span class="keyword">FROM</span> emp e,salgrade s</span><br><span class="line"><span class="keyword">WHERE</span> e.sal <span class="keyword">BETWEEN</span>  s.losal <span class="keyword">AND</span> s.hisal;</span><br></pre></td></tr></table></figure>
<p>​<img src="http://ojx4zwltq.bkt.clouddn.com/17-4-12/72600430-file_1492009517039_9088.png" alt=""></p>
</li>
</ol>
</li>
<li><p>查询每个雇员的编号，姓名，职位，工资，工资等级，部门名称。</p>
<p><strong>分析问题：</strong></p>
<ul>
<li>确定使用到的数据表<ul>
<li>emp表(编号，姓名，职位，工资)</li>
<li>salgrade表(工资等级)</li>
<li>dept表(部门名称)</li>
</ul>
</li>
<li>确定已知的关联字段<ul>
<li>emp表与dept表的 deptno。 emp.deptno = dept.deptno；</li>
<li>emp 表 sal 与salgrade表的 lasal,hisal。 emp.sal BETWEEN  salgrade.losal AND salgrade.hisal；</li>
</ul>
</li>
</ul>
<p><strong>解决问题：</strong></p>
<ol>
<li><p>第一步：查询出每个雇员的编号、姓名、基本工资、职位、工资</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> e.empno,e.ename,e.job,e.sal</span><br><span class="line"><span class="keyword">FROM</span> emp e;</span><br></pre></td></tr></table></figure>
</li>
<li><p>第二步：引入工资等级表，同时增加一个消除笛卡尔积的条件</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> e.empno,e.ename,e.job,e.sal,s.grade</span><br><span class="line"><span class="keyword">FROM</span> emp e,salgrade s</span><br><span class="line"><span class="keyword">WHERE</span> e.sal <span class="keyword">BETWEEN</span>  s.losal <span class="keyword">AND</span> s.hisal;</span><br></pre></td></tr></table></figure>
</li>
<li><p>第三步：引入部门表，继续增加消除笛卡尔积的条件</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> e.empno,e.ename,e.job,e.sal,s.grade,d.dname</span><br><span class="line"><span class="keyword">FROM</span> emp e,salgrade s,dept d</span><br><span class="line"><span class="keyword">WHERE</span> e.deptno=d.deptno <span class="keyword">AND</span> e.sal <span class="keyword">BETWEEN</span>  s.losal <span class="keyword">AND</span> s.hisal;</span><br></pre></td></tr></table></figure>
<p>​<img src="http://ojx4zwltq.bkt.clouddn.com/17-4-12/59190297-file_1492009756970_67e7.png" alt=""></p>
</li>
</ol>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/08/27/8.查询（多表）/" data-id="cjlc5t05p000azctqmd1iqfrw" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-7.查询（分页）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/27/7.查询（分页）/" class="article-date">
  <time datetime="2018-08-27T09:56:37.416Z" itemprop="datePublished">2018-08-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="分页查询"><a href="#分页查询" class="headerlink" title="分页查询"></a>分页查询</h1><h3 id="1、说明"><a href="#1、说明" class="headerlink" title="1、说明"></a>1、说明</h3><p>​    Mysql分页采用 <strong>LIMIT</strong> 关键字</p>
<h3 id="2、语法格式"><a href="#2、语法格式" class="headerlink" title="2、语法格式"></a>2、语法格式</h3><ol>
<li><p>格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM table  LIMIT [offset,] rows </span><br><span class="line"></span><br><span class="line">SELECT * FROM table  LIMIT rows OFFSET offset</span><br></pre></td></tr></table></figure>
</li>
<li><p>说明</p>
<ul>
<li>第一个参数指定第一个返回记录行的偏移量</li>
<li>第二个参数指定返回记录行的最大数目</li>
<li>如果只给定一个参数：它表示返回最大的记录行数目</li>
<li>第二个参数为 -1 表示检索从某一个偏移量到记录集的结束所有的记录行</li>
<li>初始记录行的偏移量是 0(而不是 1)</li>
</ul>
</li>
</ol>
<h3 id="3、示例代码"><a href="#3、示例代码" class="headerlink" title="3、示例代码"></a>3、示例代码</h3><ol>
<li><p>查询6-10条数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM table LIMIT 5,5; </span><br><span class="line">-- 检索记录行 6-10 条数据</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询从某一个偏移量到记录集的结束所有的记录行，可以指定第二个参数为 -1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM emp LIMIT 5,-1;</span><br><span class="line">-- 检索记录行 6-最后一条.</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询前 5 条记录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM emp LIMIT 5</span><br><span class="line">-- LIMIT n 等价于 LIMIT 0,n</span><br></pre></td></tr></table></figure>
</li>
<li><p>返回4行，9表示从表的第10行开始</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM emp LIMIT 4 OFFSET 9</span><br><span class="line">-- 等价于 select * from Emp limit 9,4</span><br></pre></td></tr></table></figure></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/08/27/7.查询（分页）/" data-id="cjlc5t05m0008zctqkiq9bran" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-6.查询（函数）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/27/6.查询（函数）/" class="article-date">
  <time datetime="2018-08-27T09:56:37.410Z" itemprop="datePublished">2018-08-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="四、函数查询"><a href="#四、函数查询" class="headerlink" title="四、函数查询"></a>四、函数查询</h1><h2 id="一、概要"><a href="#一、概要" class="headerlink" title="一、概要"></a>一、概要</h2><blockquote>
<p>函数是一种有零个或多个参数并且有一个返回值的程序,函数主要分为两大类单行函数,多行函数(聚合函数)</p>
</blockquote>
<h2 id="二、单行函数"><a href="#二、单行函数" class="headerlink" title="二、单行函数"></a>二、单行函数</h2><h3 id="1、定义"><a href="#1、定义" class="headerlink" title="1、定义"></a>1、定义</h3><p>​    单行函数: 对每一个函数应用在表的记录中时，只能输入一行结果，返回一个结果。</p>
<h3 id="2、分类"><a href="#2、分类" class="headerlink" title="2、分类"></a>2、分类</h3><ol>
<li>字符函数</li>
<li>数值函数</li>
<li>日期函数</li>
<li>转换函数</li>
<li>通用函数</li>
</ol>
<h3 id="2-3、字符函数"><a href="#2-3、字符函数" class="headerlink" title="2.3、字符函数"></a>2.3、字符函数</h3><h4 id="1、UPPER"><a href="#1、UPPER" class="headerlink" title="1、UPPER"></a>1、UPPER</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">将输入的字符串变为大写返回；</span><br></pre></td></tr></table></figure>
</li>
<li><p>作用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在一般的使用之中，用户输入数据的时候不关心数据本身存放的是大写还是小写</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">upper（列 | 字符串）</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<p>1、将abcd改变成大写</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT UPPER(&apos;abcd&apos;) FROM dual</span><br></pre></td></tr></table></figure>
<p>2、查询姓名为simth的员工信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * </span><br><span class="line">FROM  emp </span><br><span class="line">WHERE ename = UPPER(&apos;smith&apos;);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="2、LOWER"><a href="#2、LOWER" class="headerlink" title="2、LOWER"></a>2、LOWER</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">将输入的字符串变为小写返回</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LOWER(字符串 | 列)</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<p>1、将员工姓名转化成小写显示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT lower(ename)</span><br><span class="line">FROM  emp</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="3、REPLACE"><a href="#3、REPLACE" class="headerlink" title="3、REPLACE"></a>3、REPLACE</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">字符串进行替换</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">REPLACE(字符串 | 列,   被替换的字符串，  用来替换的字符串)</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<p>使用字母’*’替换掉姓名中的所有字母’s’</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT REPLACE(ename,&apos;S&apos;,&apos;*&apos;) FROM emp</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="4、LENGTH"><a href="#4、LENGTH" class="headerlink" title="4、LENGTH"></a>4、LENGTH</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">求出字符串的长度</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LENGTH(字符串 | 列)</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<p>查询出每个雇员姓名的长度</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT LENGTH(ename) </span><br><span class="line">FROM emp;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="5、INITCAP"><a href="#5、INITCAP" class="headerlink" title="5、INITCAP"></a>5、INITCAP</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">首字母大写</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INITCAP(字符串 | 列)</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<p>将员工的姓名全部大写字母开头</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT initcap(ename) </span><br><span class="line">FROM emp;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="6、SUBSTR（注意：从0和1开始截取都是从字符串的第一位开始）"><a href="#6、SUBSTR（注意：从0和1开始截取都是从字符串的第一位开始）" class="headerlink" title="6、SUBSTR（注意：从0和1开始截取都是从字符串的第一位开始）"></a>6、SUBSTR（注意：从0和1开始截取都是从字符串的第一位开始）</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">字符串截取,开始点可以是正也可以是负,如果是负表示从后面开始截取 ,如果长度不写,默认截取到末尾</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SUBSTR(字符串 | 列，开始点, 长度)</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<p>1、从开始点一直截取到结尾</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT SUBSTR(&apos;abcdefg&apos;,2) from  dual; --bcdefg</span><br></pre></td></tr></table></figure>
<p>2、从开始点截取到结束点，截取部分内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT SUBSTR(&apos;abcdefg&apos;,2,4) from  dual;--bcde</span><br></pre></td></tr></table></figure>
<p>3、要求截取每个雇员姓名的后2个字母</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT ename,SUBSTR(ename,LENGTH(ename)-1) FROM emp;</span><br><span class="line">等价于</span><br><span class="line">SELECT ename,SUBSTR(ename,-2) FROM emp;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="2-4、数值函数"><a href="#2-4、数值函数" class="headerlink" title="2.4、数值函数"></a>2.4、数值函数</h3><h4 id="1、ROUND"><a href="#1、ROUND" class="headerlink" title="1、ROUND"></a>1、ROUND</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">四舍五入的操作 默认保留0位</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROUND(数字 | 列 [,保留小数的位数])</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT  ROUND(100.12),</span><br><span class="line">ROUND(100.12 ,1) ,</span><br><span class="line">ROUND(-100.56), </span><br><span class="line">ROUND(-100.56,1), </span><br><span class="line">ROUND(-100.567123,3)</span><br><span class="line">FROM DUAL;</span><br><span class="line">100           100.1           -101           -100.6             -100.567</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="2、TRUNC"><a href="#2、TRUNC" class="headerlink" title="2、TRUNC"></a>2、TRUNC</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">舍弃指定位置的内容</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TRUNC(数字 | 列 [,保留小数的位数])</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT TRUNC(903.53567),TRUNC(-903.53567), TRUNC(903.53567,2), TRUNC(-90353567,-1) </span><br><span class="line">FROM dual;</span><br><span class="line"></span><br><span class="line">903              -903             903.53           -90353560</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="3、MOD"><a href="#3、MOD" class="headerlink" title="3、MOD"></a>3、MOD</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">取余数</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MOD(数字 1，数字2)</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT MOD(10,3) FROM dual</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="2-5、日期函数"><a href="#2-5、日期函数" class="headerlink" title="2.5、日期函数"></a>2.5、日期函数</h3><h4 id="1、NOW："><a href="#1、NOW：" class="headerlink" title="1、NOW："></a>1、NOW：</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">返回服务器的当前日期和时间(fsp指定小数秒的精度，取值0--6)</span><br><span class="line">格式 ‘YYYY-MM-DD HH:MM:SS’或者‘YYYYMMDDHHMMSS’</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NOW([fsp])</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- now()的显示格式是‘YYYY-MM-DD HH:MM:SS’</span><br><span class="line">select now();</span><br><span class="line">-- now()+0的显示格式是‘YYYYMMDDHHMMSS’</span><br><span class="line">select now()+0;</span><br><span class="line">-- 指定小数秒的精度  2018-04-19 01:55:46.658198</span><br><span class="line">select now(6);</span><br></pre></td></tr></table></figure>
</li>
<li><p>其它相同的还有</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CURRENT_TIMESTAMP  </span><br><span class="line">CURRENT_TIMESTAMP()</span><br><span class="line">LOCALTIMESTAMP</span><br><span class="line">LOCALTIMESTAMP()</span><br><span class="line">LOCALTIME</span><br><span class="line">LOCALTIME()</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="2、CURTIME"><a href="#2、CURTIME" class="headerlink" title="2、CURTIME"></a>2、CURTIME</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">返回当前时间，只包含时分秒(fsp指定小数秒的精度，取值0--6)</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CURTIME([fsp])</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select curtime()</span><br><span class="line"># 01:55:47</span><br><span class="line">select curtime()+0</span><br><span class="line"># 163301</span><br><span class="line">select curtime(2) 　 </span><br><span class="line"># 01:55:47.90</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="2、CURDATE"><a href="#2、CURDATE" class="headerlink" title="2、CURDATE"></a>2、CURDATE</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">返回当前日期，只包含年月日</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CURDATE()</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select curdate()</span><br><span class="line">select curdate()+0</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="3、选取日期时间的各个部分"><a href="#3、选取日期时间的各个部分" class="headerlink" title="3、选取日期时间的各个部分"></a>3、选取日期时间的各个部分</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">日期、时间、年、季度、月、日、小时、分钟、秒、微秒</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">SELECT now(),date(now()); -- 日期</span><br><span class="line">SELECT now(),time(now()); -- 时间</span><br><span class="line">SELECT now(),year(now()); -- 年</span><br><span class="line">SELECT now(),quarter(now()); -- 季度</span><br><span class="line">SELECT now(),month(now()); -- 月</span><br><span class="line">SELECT now(),week(now()); -- 周</span><br><span class="line">SELECT now(),day(now()); -- 日</span><br><span class="line">SELECT now(),hour(now()); -- 小时</span><br><span class="line">SELECT now(),minute(now()); -- 分钟</span><br><span class="line">SELECT now(),second(now()); -- 秒</span><br><span class="line">SELECT now(),microsecond(now()); -- 微秒</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="2-6、转换函数"><a href="#2-6、转换函数" class="headerlink" title="2.6、转换函数"></a>2.6、转换函数</h3><p>转换函数将值从一种数据类型转换为另外一种数据类型</p>
<h4 id="1、date-format-date-format"><a href="#1、date-format-date-format" class="headerlink" title="1、date_format(date, format)"></a>1、date_format(date, format)</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">把日期和数字转换为制定格式的字符串。format是格式化字符串</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">date_format(date, format)</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<p>对日期的处理</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select date_format(now(), &apos;%Y-%m-%d&apos;);</span><br><span class="line">-- 2017-07-24</span><br><span class="line">select date_format(now(), &apos;%Y-%m-%d %H:%I:%S&apos;);</span><br><span class="line">-- 2017-07-24 15:03:44</span><br></pre></td></tr></table></figure>
</li>
<li><p>附表</p>
<p>|      | 值     | 含义                                                         |<br>| —- | —— | ———————————————————— |<br>| 秒   | %S %s  | 两位数字形式的秒（ 00,01, …, 59）                          |<br>| 分   | % I %i | 两位数字形式的分（ 00,01, …, 59）                          |<br>| 小时 | %H %h  | 24小时制， 12小时制                                          |<br>| 天   | %d     | 两位数字表示月中天数（01,02, …,31）                        |<br>| 月   | %m     | 两位数字表示月份（01,02, …,12）                            |<br>| 年   | %Y  %y | 四位数字表示的年份（2017,2018…） 两位数字表示的年份（15,16…） |</p>
</li>
</ol>
<h4 id="2、str-to-date-str-format"><a href="#2、str-to-date-str-format" class="headerlink" title="2、str_to_date(str, format)"></a>2、str_to_date(str, format)</h4><ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">将一个字符串变为DATE型数据</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">str_to_date(str,[,format]) --注意：格式要和字符串日期的格式一致才能解析成功。</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<p>将字符串日期转化为年月日</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select str_to_date(&apos;2018-12-25&apos;, &apos;%Y-%m-%d&apos;)</span><br></pre></td></tr></table></figure>
<p>将字符串日期+时间转化成年与日时分秒</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select str_to_date(&apos;2018-12-25 13:25:59&apos;, &apos;%Y-%m-%d %H:%i:%s&apos;)</span><br><span class="line">-- 注意年是大写‘Y’，小时也必须是大写‘H’ (如果其他为大写，则得到结果为null)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="2-7、通用函数"><a href="#2-7、通用函数" class="headerlink" title="2.7、通用函数"></a>2.7、通用函数</h3><h4 id="1、ifnull"><a href="#1、ifnull" class="headerlink" title="1、ifnull"></a>1、ifnull</h4><p>主要针对null值的处理，null加任何值等于null</p>
<ol>
<li><p>说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">如果X为空，返回value，否则返回VALUE</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NVL(col|字符串,VALUE) --相当于三则运算</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<p>对工资是2000元以下的员工，如果没发奖金，每人奖金100元</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT ename,job,sal,ifnull(comm,100) FROM emp WHERE sal&lt;2000;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="三、分组函数"><a href="#三、分组函数" class="headerlink" title="三、分组函数"></a>三、分组函数</h2><h3 id="1、什么叫分组函数"><a href="#1、什么叫分组函数" class="headerlink" title="1、什么叫分组函数"></a>1、什么叫分组函数</h3><blockquote>
<p>对一组（多行）数据的处理计算并返回一行数据</p>
<p>聚合函数也叫分组函数，有的也叫集合函数，它的数据源一般来自多组数据，但返回的时候一般是一组数据，聚合函数对一组行中的某个列执行计算并返回单一的值。聚合函数经常与 SELECT 语句的 GROUP BY 子句一同使用,所以有的时候也把其称之为分组函数</p>
</blockquote>
<h3 id="2、分类-1"><a href="#2、分类-1" class="headerlink" title="2、分类"></a>2、分类</h3><blockquote>
<table>
<thead>
<tr>
<th>函数名称</th>
<th>返回值（结果）类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>SUM(DISTINCT \</td>
<td>ALL 列名)</td>
<td>数值</td>
<td>对所有数值求和</td>
</tr>
<tr>
<td>COUNT(DISTINCT \</td>
<td>ALL 列名) 或者 COUNT(*)</td>
<td>数值</td>
<td>计数，求数据行数</td>
</tr>
<tr>
<td>MAX(DISTINCT \</td>
<td>ALL   数值日期列)</td>
<td>数值</td>
<td>求最大值</td>
</tr>
<tr>
<td>MIN(DISTINCT \</td>
<td>ALL  数值日期列)</td>
<td>数值</td>
<td>求最小值</td>
</tr>
<tr>
<td>AVG(DISTINCT \</td>
<td>ALL  数值列)</td>
<td>数值</td>
<td>求平均值</td>
</tr>
</tbody>
</table>
</blockquote>
<h3 id="3、-SUM-求总和"><a href="#3、-SUM-求总和" class="headerlink" title="3、 SUM(求总和)"></a>3、 SUM(求总和)</h3><h4 id="1、-说明"><a href="#1、-说明" class="headerlink" title="1、 说明"></a>1、 说明</h4><ol>
<li>ALL表示对所有值求和</li>
<li>DISTINCT表示只对不同值求和(相同值只取一次)</li>
</ol>
<h4 id="2、示例代码"><a href="#2、示例代码" class="headerlink" title="2、示例代码"></a>2、示例代码</h4><ol>
<li><p>计算雇员姓名为 ‘SMITH’和 ‘ALLEN’ 两个人的基本薪资和</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">SUM</span>(sal) </span><br><span class="line"><span class="keyword">FROM</span> emp </span><br><span class="line"><span class="keyword">WHERE</span> ename <span class="keyword">IN</span>(<span class="string">'SMITH'</span>,<span class="string">'ALLEN'</span>);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="4、-COUNT-统计行数"><a href="#4、-COUNT-统计行数" class="headerlink" title="4、 COUNT(统计行数)"></a>4、 COUNT(统计行数)</h3><h4 id="1、-说明-1"><a href="#1、-说明-1" class="headerlink" title="1、 说明"></a>1、 说明</h4><ol>
<li><p>ALL对所有记录，数组做统计 （默认）</p>
</li>
<li><p>DISTINCT只对不同值统计(相同值只取一次)</p>
</li>
<li><p>COUNT(DISTINCT | ALL 列名)      ———会忽略null值进行统计</p>
<p>或者 COUNT(*)   ——————————–不需要考虑null值问题（开发使用较多）</p>
</li>
</ol>
<h4 id="2、-示例代码"><a href="#2、-示例代码" class="headerlink" title="2、 示例代码"></a>2、 示例代码</h4><ol>
<li><p>显示emp表中的总条数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*) </span><br><span class="line"><span class="keyword">FROM</span> emp</span><br></pre></td></tr></table></figure>
</li>
<li><p>统计 emp 职位类型的个数。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(<span class="keyword">DISTINCT</span> job) </span><br><span class="line"><span class="keyword">FROM</span> emp;</span><br></pre></td></tr></table></figure>
</li>
<li><p>统计 emp 职位为 SALESMAN 的雇员个数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*) </span><br><span class="line"><span class="keyword">FROM</span> emp </span><br><span class="line"><span class="keyword">WHERE</span> job=<span class="string">'SALESMAN'</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>统计 emp 中 有佣金的雇员的个数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(comm) </span><br><span class="line"><span class="keyword">FROM</span> emp;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="5、-MAX-求最大值"><a href="#5、-MAX-求最大值" class="headerlink" title="5、 MAX(求最大值)"></a>5、 MAX(求最大值)</h3><h4 id="1、-说明-2"><a href="#1、-说明-2" class="headerlink" title="1、 说明"></a>1、 说明</h4><ol>
<li>ALL表示对所有的值求最大值 （默认）</li>
<li>DISTINCT表示对不同的值求最大值,相同的只取一次</li>
</ol>
<h4 id="2、-示例代码-1"><a href="#2、-示例代码-1" class="headerlink" title="2、 示例代码"></a>2、 示例代码</h4><ol>
<li><p>查询所有雇员中最高的薪资</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>　<span class="keyword">MAX</span>(sal)</span><br><span class="line"><span class="keyword">FROM</span> emp;</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示所有工资不同的员工中工资最高的</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MAX</span>(<span class="keyword">DISTINCT</span> SAL) </span><br><span class="line"><span class="keyword">FROM</span> EMP;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="6、-AVG-求平均值"><a href="#6、-AVG-求平均值" class="headerlink" title="6、 AVG(求平均值)"></a>6、 AVG(求平均值)</h3><h4 id="1、-说明-3"><a href="#1、-说明-3" class="headerlink" title="1、 说明"></a>1、 说明</h4><ol>
<li>ALL表示对所有的值求平均值 （ 默认）</li>
<li>DISTINCT表示对不同的值求最大值,相同的只取一次</li>
</ol>
<h4 id="2、-示例代码-2"><a href="#2、-示例代码-2" class="headerlink" title="2、 示例代码"></a>2、 示例代码</h4><ol>
<li><p>求所有员工工资的平均值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>  (sal) </span><br><span class="line"><span class="keyword">FROM</span>  emp;</span><br></pre></td></tr></table></figure>
</li>
<li><p>求不重复的员工工资的平均值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>  <span class="keyword">AVG</span>(<span class="keyword">DISTINCT</span> sal) </span><br><span class="line"><span class="keyword">FROM</span>  emp;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="7、MIN-求最小值"><a href="#7、MIN-求最小值" class="headerlink" title="7、MIN(求最小值)"></a>7、MIN(求最小值)</h3><h4 id="1、-说明-4"><a href="#1、-说明-4" class="headerlink" title="1、 说明"></a>1、 说明</h4><ol>
<li>ALL表示对所有的值求最小值（ 默认）</li>
<li>DISTINCT表示对不同的值求最小值,相同的只取一次</li>
</ol>
<h4 id="2、-示例代码-3"><a href="#2、-示例代码-3" class="headerlink" title="2、 示例代码"></a>2、 示例代码</h4><ol>
<li><p>员工编号最小值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">min</span>(empno) </span><br><span class="line"><span class="keyword">FROM</span> emp</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询工资最低的</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MIN</span>(sal)</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询年薪最低的</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * ,<span class="keyword">MIN</span>((NVL2(comm,comm+sal,comm)*<span class="number">12</span> )</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="2-7-、注意事项"><a href="#2-7-、注意事项" class="headerlink" title="2.7 、注意事项"></a>2.7 、注意事项</h3><ol>
<li>分组函数只能出现在select 列、having、order by子句中(不能出现在where后面)</li>
<li>当使用分组函数时，除了函数count(*)外，其他分组函数都会忽略NULL行。</li>
</ol>
<h3 id="2-8、单行函数和聚合函数的区别"><a href="#2-8、单行函数和聚合函数的区别" class="headerlink" title="2.8、单行函数和聚合函数的区别"></a>2.8、单行函数和聚合函数的区别</h3><ol>
<li>单行函数操作时，根据函数的功能同时处理一行数据，返回每一行的处理结果；</li>
<li>聚合函数同时对分组后的一组行进行操作，返回分组后各组的处理结果</li>
</ol>
<h2 id="四、分组统计查询"><a href="#四、分组统计查询" class="headerlink" title="四、分组统计查询"></a>四、分组统计查询</h2><h3 id="1、概要"><a href="#1、概要" class="headerlink" title="1、概要"></a>1、概要</h3><blockquote>
<p>Group By语句从英文的字面意义上理解就是“根据(by)一定的规则进行分组(Group)”。它的作用是通过一定的规则将一个数据集划分成若干个小的区域，然后针对若干个小区域进行数据处理。 如果在查询的过程中需要按某一列的值进行分组,以统计该组内数据的信息时,就要使用group by子句。不管select是否使用了where子句都可以使用group by子句group by子句一定要与分组函数结合使用,否则没有意义。</p>
</blockquote>
<h3 id="2、语法格式"><a href="#2、语法格式" class="headerlink" title="2、语法格式"></a>2、语法格式</h3><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt; ----语句------------------------------------------------------------执行顺序-----</span><br><span class="line">&gt; </span><br><span class="line">&gt; SELECT [DISTINCT] * | 列名称 [别名] , 列名称 [别名] ,... | 统计函数   4、确定查询列</span><br><span class="line">&gt; </span><br><span class="line">&gt; FROM 数据表 [别名] , 数据表 [别名] ,...                              1、数据来源</span><br><span class="line">&gt; </span><br><span class="line">&gt; [WHERE 条件(s)]                                                     2、过滤数据行</span><br><span class="line">&gt; </span><br><span class="line">&gt; [GROUP BY 分组字段, 分组字段, ...]                                   3、执行分组操作</span><br><span class="line">&gt; </span><br><span class="line">&gt; [ORDER BY 字段 [ASC | DESC] , 字段 [ASC | DESC] ,...]               5、数据排序</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
</blockquote>
<h3 id="3、示例代码"><a href="#3、示例代码" class="headerlink" title="3、示例代码"></a>3、示例代码</h3><ol>
<li><p>查询每个部门的人数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> deptno ,<span class="keyword">COUNT</span>(*)</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno;</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示每个部门员工的平均工资</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> deptno ,<span class="keyword">AVG</span>(sal) 平均工资 </span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno;</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示各个部门员工的工资+奖金</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> deptno,<span class="keyword">SUM</span>(sal + NVL(comm,<span class="number">0</span>))</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno;</span><br></pre></td></tr></table></figure>
</li>
<li><p>按照部门编号分组，求出每个部门的人数，平均工资(要求截取2位)(配合单行函数使用)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> deptno, <span class="keyword">COUNT</span>(empno), <span class="keyword">ROUND</span>(<span class="keyword">AVG</span>(sal),<span class="number">2</span>) </span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno;</span><br></pre></td></tr></table></figure>
</li>
<li><p>按照职位分组，求出每个职位的最高和最低工资(单字段分组)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> job, <span class="keyword">MAX</span>(sal), <span class="keyword">MIN</span>(sal)</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询每个部门的每种岗位的平均工资和最低工资</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">AVG</span>(sal), <span class="keyword">MIN</span>(sal)</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno;</span><br></pre></td></tr></table></figure>
</li>
<li><p>先统计出各个职位(job)的平均工资(AVG),再统计平均工资最高的工资(分组函数嵌套)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MAX</span>(<span class="keyword">AVG</span>(sal))</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job</span><br><span class="line">注意:分组函数允许嵌套，但是嵌套之后的分组函数的查询之中不能再出现任何的其他字段</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询每个岗位的总工资但不包括’SALESMAN’岗位(配合Where使用)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">name</span> !=<span class="string">'SALESMAN'</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>按部门、不同的职位，统计员工的工资总额 (多字段统计)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> deptno, job, <span class="keyword">sum</span>(sal)</span><br><span class="line"><span class="keyword">FROM</span> emp   </span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno, job;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询各个部门中相同职位的员工人数并且按部门编号排序(多字段统计排序)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DEPTNO, JOB,<span class="keyword">COUNT</span>(*) </span><br><span class="line"><span class="keyword">FROM</span>  emp</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno,job  </span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> deptno;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询出每个部门的名称、部门的人数、平均工资(多表单字段查询)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1、确定表</span><br><span class="line">    dept表</span><br><span class="line">    emp表</span><br><span class="line">2、确定关联字段</span><br><span class="line">    deptno</span><br><span class="line">3. 查询</span><br><span class="line">  <span class="keyword">SELECT</span> dname,<span class="keyword">count</span>(e.empno),<span class="keyword">AVG</span>(sal)</span><br><span class="line">  <span class="keyword">FROM</span> emp e,dept d</span><br><span class="line">  <span class="keyword">WHERE</span>  e.deptno(+) = d.deptno</span><br><span class="line">  <span class="keyword">group</span> <span class="keyword">by</span> dname;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="4、注意事项"><a href="#4、注意事项" class="headerlink" title="4、注意事项"></a>4、注意事项</h3><ol>
<li><p>GROUP BY后不可以接列的别名（根据执行顺序分析就知道了）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>  deptno dn ,<span class="keyword">AVG</span>(sal)</span><br><span class="line"><span class="keyword">FROM</span> emp  </span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> dn;  <span class="comment">--错误</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>GROUP BY 后不能接数字</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>  deptno dn ,<span class="keyword">AVG</span>(sal)</span><br><span class="line"><span class="keyword">FROM</span> emp  </span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="number">1</span>;   <span class="comment">--错误</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>GROUP BY 后可以接select后没有的列名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>  deptno dn ,<span class="keyword">AVG</span>(sal) </span><br><span class="line"><span class="keyword">FROM</span> emp  </span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job;</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果一个SELECT中使用了分组函数，任何不在分组函数中的列(表达式)必须要在GROUP BY中</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>  job ,deptno dn ,<span class="keyword">AVG</span>(sal) <span class="comment">--deptno列group by 后面没有，使用会报错</span></span><br><span class="line"><span class="keyword">FROM</span> emp  </span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>笔记：3和4总结为一句话</p>
<p>1、在select中出现的列名必须在group by 中出现，否则，其他列名只能在分组函数中使用;而在group by 中出现的字段不一定要在select中出现</p>
</blockquote>
</li>
<li><p>group by之前可以使用where过滤数据,因为where是在分组之前起作用的，(执行顺序分析)     —-废话</p>
</li>
</ol>
<h3 id="5、使用HAVING过滤分组"><a href="#5、使用HAVING过滤分组" class="headerlink" title="5、使用HAVING过滤分组"></a>5、使用HAVING过滤分组</h3><h4 id="1、说明"><a href="#1、说明" class="headerlink" title="1、说明"></a>1、说明</h4><ol>
<li><p>首先对数据行进行分组。</p>
</li>
<li><p>把所得到的分组应用到分组函数中。</p>
</li>
<li><p>最后显示满足having条件的记录</p>
<blockquote>
<p>作用：在分组之后再过滤掉不符合条件的分组</p>
</blockquote>
</li>
</ol>
<h4 id="2、与where的区别"><a href="#2、与where的区别" class="headerlink" title="2、与where的区别"></a>2、与where的区别</h4><p>​    1.只有having里面可以使用分组函数，where中不允许出现分组函数</p>
<p>​    2.相同作用——都是根据条件过滤数据；不同的是where是在分组之前过滤数据，having是分组之后过滤分组数据。</p>
<p>​    3.原则：能在where里过滤的数据就不要在having里面去过滤</p>
<h4 id="3、语法格式"><a href="#3、语法格式" class="headerlink" title="3、语法格式"></a>3、语法格式</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt; ----语句-----------------------------------------------------------执行顺序---------</span><br><span class="line">&gt; </span><br><span class="line">&gt; SELECT [DISTINCT] * | 列名称 [别名] , 列名称 [别名] ,... | 统计函数   5、确定查询列</span><br><span class="line">&gt; </span><br><span class="line">&gt; FROM 数据表 [别名] , 数据表 [别名] ,...                              1、数据来源</span><br><span class="line">&gt; </span><br><span class="line">&gt; [WHERE 条件(s)]                                                     2、过滤数据行</span><br><span class="line">&gt; </span><br><span class="line">&gt; [GROUP BY 分组字段, 分组字段, ...]    [HIAVING 过滤分组]              3、执行分组操作</span><br><span class="line">&gt; </span><br><span class="line">&gt; [HAVING 条件(s)]                                                    4、过滤分组数据</span><br><span class="line">&gt; </span><br><span class="line">&gt; [ORDER BY 字段 [ASC | DESC] , 字段 [ASC | DESC] ,...]               6、数据排序</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="4、示例代码"><a href="#4、示例代码" class="headerlink" title="4、示例代码"></a>4、示例代码</h4><ol>
<li><p>查询部门的员工人数大于五部门编号</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> deptno,<span class="keyword">COUNT</span>(*)</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno </span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(*)&gt; <span class="number">5</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询部门工资总和大于10000的部门编号</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> deptno, <span class="keyword">SUM</span>(sal) </span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno </span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">SUM</span>(sal)&gt;<span class="number">10000</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询平均工资低于2000的部门号和它的平均工资</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> deptno,<span class="keyword">AVG</span>(sal) a</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> deptno </span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">avg</span>(sal)&gt;<span class="number">2000</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询每个岗位的总工资并且不包括职位是’SALESMAN’岗位而且工资和大于5000</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">SUM</span>(sal)</span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> job!=<span class="string">'SALESMAN'</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job  <span class="keyword">HAVING</span> <span class="keyword">SUM</span>(sal)&gt;<span class="number">5000</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="6、综合示例"><a href="#6、综合示例" class="headerlink" title="6、综合示例"></a>6、综合示例</h3><ol>
<li><p>查询非销售人员工作名称以及从事同一工作雇员的月工资的总和，并且要满足从事同一工作的雇员的月工资合计大于$5000，输出结果按月工资的合计升序排列</p>
<p>1、查询出所有的非销售人员的信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM emp WHERE job!=SALESMAN&apos;;</span><br></pre></td></tr></table></figure>
<p>2、按照职位进行分组，并且使用SUM函数统计</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT job,SUM(sal)</span><br><span class="line">FROM emp</span><br><span class="line">WHERE job&lt;&gt;&apos;SALESMAN&apos;</span><br><span class="line">GROUP BY job;</span><br></pre></td></tr></table></figure>
<p>3、月工资的合计是通过统计函数查询的，所以现在这个对分组后的过滤要使用HAVING子句完成</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT job,SUM(sal)</span><br><span class="line">FROM emp</span><br><span class="line">WHERE job!=&apos;SALESMAN&apos;</span><br><span class="line">GROUP BY job</span><br><span class="line">HAVING SUM(sal)&gt;5000;</span><br></pre></td></tr></table></figure>
<p>4、按照升序排列</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> job,<span class="keyword">SUM</span>(sal) <span class="keyword">sum</span></span><br><span class="line"><span class="keyword">FROM</span> emp</span><br><span class="line"><span class="keyword">WHERE</span> job!=<span class="string">'SALESMAN'</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job</span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">SUM</span>(sal)&gt;<span class="number">5000</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">sum</span> <span class="keyword">ASC</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示部门编号不是30的，的部门详细信息（部门编号、部门名称、部门人数、部门月薪资总和），并要求 部门月工资总和大于8000，输出结果按部门月薪资的总和降序排列。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> d.deptno,d.dname,<span class="keyword">COUNT</span>(*) 人数,NVL(<span class="keyword">SUM</span>(e.sal),<span class="number">0</span>) 月总收入</span><br><span class="line"><span class="keyword">FROM</span> dept d,emp e</span><br><span class="line"><span class="keyword">WHERE</span> d.deptno=e.deptno(+) <span class="keyword">AND</span> d.deptno!=<span class="number">30</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> d.deptno,d.dname</span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">SUM</span>(e.sal) &gt;<span class="number">8000</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">SUM</span>(e.sal) <span class="keyword">DESC</span>;</span><br><span class="line">或</span><br><span class="line"><span class="keyword">select</span> deptno,d.dname ,<span class="keyword">count</span>(*) peonum,<span class="keyword">sum</span>(e.sal) s</span><br><span class="line"><span class="keyword">from</span> dept d <span class="keyword">left</span> <span class="keyword">join</span> emp e <span class="keyword">using</span>(deptno)  <span class="comment">--注意:using()中的字段在使用时不能有前缀。</span></span><br><span class="line"><span class="keyword">where</span> deptno !=<span class="number">30</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> deptno ,d.dname</span><br><span class="line"><span class="keyword">having</span> <span class="keyword">sum</span>(e.sal)&gt;<span class="number">8000</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> s <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="7、性能问题"><a href="#7、性能问题" class="headerlink" title="7、性能问题"></a>7、性能问题</h3><blockquote>
<p>能在where能过滤数据不要在having里过滤，A和B都能达到同样的目的，但是A性能相对好一些，因为A现将deptno=30的数据筛选出来，然后在将筛选的数据放入到临时表空间内进行分组；而B将全部的数据都读到临时表空间内，然后在临时表空间进行筛选数据，这样一来B就需要更大的临时表空间进行分组筛选，索引性能较差。</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/08/27/6.查询（函数）/" data-id="cjlc5t05o0009zctq62zeq5o5" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-5.查询（排序）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/27/5.查询（排序）/" class="article-date">
  <time datetime="2018-08-27T09:56:37.404Z" itemprop="datePublished">2018-08-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="限定查询（排序）"><a href="#限定查询（排序）" class="headerlink" title="限定查询（排序）"></a>限定查询（排序）</h1><h2 id="1、概要"><a href="#1、概要" class="headerlink" title="1、概要"></a>1、概要</h2><blockquote>
<p>当数据返回查询结果之后，所有的数据默认情况下是按照员工编号排序的，当然，现在也可以使用”ORDER BY”子句指定所需要的排序的操作列排序的方式主要有两种</p>
</blockquote>
<ol>
<li><p>排序</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">升序（ASC）：默认，不写也是升序；</span><br></pre></td></tr></table></figure>
</li>
<li><p>降序排序</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">降序（DESC）：用户需要指定，由大到小排序；</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="2、语法格式"><a href="#2、语法格式" class="headerlink" title="2、语法格式"></a>2、语法格式</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; SELECT [DISTINCT] * | 列名 [别名] ,列名 [别名] , --3、控制要显示的数据列</span><br><span class="line">&gt; FROM 表名称 [别名]             		           --1、确定数据来源</span><br><span class="line">&gt; [WHERE 条件(s)] ;        					     --2、根据判断条件选择参与的数据行</span><br><span class="line">&gt; [ORDER BY 字段 [ASC|DESC] [,字段 [ASC|DESC],…]];--4、排序（放在语句最后，也是语句最后执行的部分）</span><br><span class="line">&gt; --说明：排序时首先按第一字段排序，若第一字段相同则按第二字段进行排序，以此类推。</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="3-示例代码"><a href="#3-示例代码" class="headerlink" title="3 示例代码"></a>3 示例代码</h2><ol>
<li><p>说明</p>
<p>ORDER BY 子句永远是最后执行,所以一般写在所有的SQL语句的最后</p>
</li>
<li><p>示例代码</p>
<p>1、查询所有的雇员的信息，要求按照工资排序</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT * </span><br><span class="line">FROM emp</span><br><span class="line">ORDER BY sal;</span><br><span class="line"># 等价于</span><br><span class="line">SELECT *</span><br><span class="line">FROM emp </span><br><span class="line">ORDER BY sal ASC;</span><br></pre></td></tr></table></figure>
<p>2、按工资降序对员工信息进行排序 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * </span><br><span class="line">FROM emp</span><br><span class="line">ORDER BY sal DESC</span><br></pre></td></tr></table></figure>
<p>3、查询出所有的员工信息，按照工资由高到低排序，如果工资相同，则按照雇佣日期由早到晚排序,此时肯定需要两个字段排序：工资（DESC），雇佣日期（ASC）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * </span><br><span class="line">FROM emp </span><br><span class="line">ORDER BY sal DESC, hiredate ASC</span><br></pre></td></tr></table></figure>
<p>4、查询出所有的雇员信息,按照年薪升序排序</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT empno,ename,(sal*12) income </span><br><span class="line">FROM emp </span><br><span class="line">ORDER BY income ;--注意必须使用别名。</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/08/27/5.查询（排序）/" data-id="cjlc5t05v000dzctqvfk0180n" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-4.查询（控制行）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/27/4.查询（控制行）/" class="article-date">
  <time datetime="2018-08-27T09:56:37.400Z" itemprop="datePublished">2018-08-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="限定查询（控制行）"><a href="#限定查询（控制行）" class="headerlink" title="限定查询（控制行）"></a>限定查询（控制行）</h1><h2 id="1、概要"><a href="#1、概要" class="headerlink" title="1、概要"></a>1、概要</h2><blockquote>
<p>在之前的简单查询中，是将所有的记录进行显示，但是现在可以对显示的记录进行过滤的操作，而这就属于限定查询的工作了，限定查询就是在之前语法的基础上增加了一个WHERE子句，用于指定限定条件</p>
<p>在使用 WHERE 子句操作的时候可以进行条件的判断，而对于条件的判断主要有以下几类操作</p>
</blockquote>
<ol>
<li><p>关系运算</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;、&lt;、=、&gt;=、&lt;=、!=（&lt;&gt;）</span><br></pre></td></tr></table></figure>
</li>
<li><p>范围判断</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BETWEEN AND</span><br></pre></td></tr></table></figure>
</li>
<li><p>判断是否为空</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">IS NULL</span><br><span class="line">IS NOT NULL</span><br></pre></td></tr></table></figure>
</li>
<li><p>指定范围的判断</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">IN </span><br><span class="line">NOT IN</span><br></pre></td></tr></table></figure>
</li>
<li><p>模糊查询</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LIKE</span><br><span class="line">NOT LIKE</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="2、语法格式"><a href="#2、语法格式" class="headerlink" title="2、语法格式"></a>2、语法格式</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT [DISTINCT] * | 列名 [别名] ,列名 [别名] , --3、 控制要显示的数据列</span><br><span class="line">FROM 表名称 [别名]  --1、 确定数据来源</span><br><span class="line">[WHERE 条件(s)] ; -- 2、 根据判断条件选择参与的数据行</span><br></pre></td></tr></table></figure>
<h2 id="3、限定操作符"><a href="#3、限定操作符" class="headerlink" title="3、限定操作符"></a>3、限定操作符</h2><h3 id="3-1、关系运算-gt-、-lt-、-gt-、-lt-、-lt-gt-、"><a href="#3-1、关系运算-gt-、-lt-、-gt-、-lt-、-lt-gt-、" class="headerlink" title="3.1、关系运算(&gt;、&lt;、&gt;=、&lt;=、&lt;&gt;、!=)"></a>3.1、关系运算(&gt;、&lt;、&gt;=、&lt;=、&lt;&gt;、!=)</h3><h4 id="3-1-1、等于-、不等于-或者-lt-gt"><a href="#3-1-1、等于-、不等于-或者-lt-gt" class="headerlink" title="3.1.1、等于(=)、不等于(!=或者&lt;&gt;)"></a>3.1.1、等于(=)、不等于(!=或者&lt;&gt;)</h4><ol>
<li><p>查询出所有职位是办事员的雇员信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1.错误的写法</span><br><span class="line">  SELECT * </span><br><span class="line">  FROM emp </span><br><span class="line">  WHERE job=&apos;clerk&apos;(所有的数据都是区分大小写的)</span><br><span class="line">2.正确的写法</span><br><span class="line">  SELECT * </span><br><span class="line">  FROM emp </span><br><span class="line">  WHERE job=&apos;CLERK&apos;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查出员工工资不等于1500的员工信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM  EMP</span><br><span class="line">WHERE sal !=1500;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询所有职位不是销售人员的信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * </span><br><span class="line">FROM emp </span><br><span class="line">WHERE job&lt;&gt;&apos;SALESMAN&apos; ;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="3-1-2、小于-lt-、小于等于-lt"><a href="#3-1-2、小于-lt-、小于等于-lt" class="headerlink" title="3.1.2、小于&lt;、小于等于 &lt;="></a>3.1.2、小于&lt;、小于等于 &lt;=</h4><ol>
<li><p>查询出基本工资不大于1500</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * </span><br><span class="line">FROM emp </span><br><span class="line">WHERE sal &lt;= 1500;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="3-1-3、大于-gt-、-大于等于-gt"><a href="#3-1-3、大于-gt-、-大于等于-gt" class="headerlink" title="3.1.3、大于&gt;、 大于等于&gt;="></a>3.1.3、大于<strong>&gt;</strong>、 大于等于<strong>&gt;=</strong></h4><ol>
<li><p>找出奖金高于工资的员工</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT * </span><br><span class="line">FROM  empWHERE comm&gt;sal;</span><br></pre></td></tr></table></figure>
</li>
<li><p>找出工资大于或等于3000的员工</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT ename ,sal </span><br><span class="line">FROM emp</span><br><span class="line">WHERE sal&gt;=3000;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询81年以后入职的员工所有信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Navicat中的写法：</span><br><span class="line">SELECT *  </span><br><span class="line">FROM EMP </span><br><span class="line">WHERE HIREDATE &gt; date &apos;1981-01-1&apos;</span><br><span class="line"># 或者</span><br><span class="line">SELECT * </span><br><span class="line">FROM EMP</span><br><span class="line">WHERE HIREDATE &gt; &apos;1-1月-81&apos;;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="3-2、逻辑运算-AND-OR"><a href="#3-2、逻辑运算-AND-OR" class="headerlink" title="3.2、逻辑运算(AND OR)"></a>3.2、逻辑运算(AND OR)</h3><ol>
<li><p>说明</p>
<p>在使用where 语句的时候可能会存在编写多个条件的情况,那这个时候就必须使用逻辑运算符了</p>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AND：条件 AND 条件 AND 条件； 所有条件都要同时满足</span><br><span class="line">OR：条件 OR 条件 OR 条件；所有条件只要有一个满足即可</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<p>1、查询工资在1500~3000之间的全部雇员信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT * </span><br><span class="line">FROM emp</span><br><span class="line">WHERE sal</span><br><span class="line">&gt;=1500 AND sal&lt;=3000;</span><br></pre></td></tr></table></figure>
<p>2、查询出职位是办事员(job=’CLERK’)，或者是销售人员(job=’SALESMAN’)的全部信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * </span><br><span class="line">FROM emp</span><br><span class="line">WHERE job=&apos;CLERK&apos; OR job=&apos;SALESMAN&apos;;</span><br></pre></td></tr></table></figure>
<p>3、查询出职位是办事员(job=’CLERK’)，或者是销售人员(job=’SALESMAN’)的全部信息，并且要求这些雇员的工资大于1200</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * </span><br><span class="line">FROM emp</span><br><span class="line">WHERE (job=&apos;CLERK&apos; OR job=&apos;SALESMAN&apos;) AND sal&gt;1200;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="3-3、范围判断-BETWEEN-AND"><a href="#3-3、范围判断-BETWEEN-AND" class="headerlink" title="3.3、范围判断(BETWEEN AND)"></a>3.3、范围判断(BETWEEN AND)</h3><ol>
<li><p>说明</p>
<p>表示的是一个范围的判断过程</p>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BETWEEN 最小值 AND 最大值”，</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<p>1、查出工资在1000~2000之间的员工</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * </span><br><span class="line">FROM emp</span><br><span class="line">WHERE sal BETWEEN  1000 AND 2000;</span><br></pre></td></tr></table></figure>
<p>2、查出在1985年1月20至1987年5月20之间入职的员工</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SELECT * </span><br><span class="line">FROM emp</span><br><span class="line">WHERE hiredate BETWEEN  &apos;20-1月 -85&apos; AND &apos;20-5月 -87&apos;;</span><br><span class="line"></span><br><span class="line">SELECT *</span><br><span class="line">FROM emp</span><br><span class="line">WHERE hiredate </span><br><span class="line">BETWEEN date &apos;1985-01-01&apos; </span><br><span class="line">AND date &apos;1985-05-20&apos;;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="3-4、判断是否为空-IS-NOT-NULL"><a href="#3-4、判断是否为空-IS-NOT-NULL" class="headerlink" title="3.4、判断是否为空(IS [NOT] NULL)"></a>3.4、判断是否为空(IS [NOT] NULL)</h3><ol>
<li><p>查询出所有领取奖金的雇员信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT * </span><br><span class="line">FROM emp</span><br><span class="line">WHERE comm IS NOT NULL;</span><br><span class="line"></span><br><span class="line">SELECT * </span><br><span class="line">FROM emp</span><br><span class="line">WHERE NOT comm IS NULL;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询出所有不领取奖金的雇员</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * </span><br><span class="line">FROM emp</span><br><span class="line">WHERE comm IS NULL</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="3-5、指定范围的判断-NOT-IN"><a href="#3-5、指定范围的判断-NOT-IN" class="headerlink" title="3.5、指定范围的判断([NOT] IN)"></a>3.5、指定范围的判断([NOT] IN)</h3><ol>
<li><p>说明</p>
<p>IN操作符表示的是指定一个查询的范围</p>
</li>
<li><p>语法格式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">字段 IN (数值,数值,…)</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<p>1、查询出雇员编号是7369、7566、7799的雇员信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * </span><br><span class="line">FROM emp</span><br><span class="line">WHERE empno=7369 OR empno=7566 OR empno=7799</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * </span><br><span class="line">FROM emp</span><br><span class="line">WHERE empno IN (7369,7566,7799);</span><br></pre></td></tr></table></figure>
<p>2、查询出姓名为 SMITH,ALLEN,KING的雇员信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * </span><br><span class="line">FROM emp </span><br><span class="line">WHERE ename in (&apos;SMITH&apos;,&apos;ALLEN&apos;, &apos;KING&apos;);</span><br></pre></td></tr></table></figure>
<p>3、查询出雇员编号不是7369、7566、7799的雇员信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * </span><br><span class="line">FROM emp</span><br><span class="line">WHERE not empno IN (7369,7566,7799);</span><br></pre></td></tr></table></figure>
</li>
<li><p>注意事项</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">关于NOT IN的问题</span><br><span class="line">如果现在使用了IN操作符，查询的范围之中存在了null，不影响查询；</span><br><span class="line">SELECT * FROM emp WHERE empno IN(7369,7566,null);</span><br><span class="line">empno in (7369,7566,null)可以等价于empno=7369 or empno=7566 or empno=null，</span><br><span class="line"></span><br><span class="line">如果现在使用的是NOT IN操作符，如果查询范围之中有了null则表示的就是查询全部数据但实际上不返回任何数据。SELECT * FROM emp WHERE empno NOT IN(7369,7566,null);</span><br><span class="line">empno not in (7369,7566,null)可以等价于not(7566=7369 or 7566=7566 or empno=null)</span><br><span class="line">或empno!=7566 and empno!=7566 and empno=null。</span><br><span class="line"></span><br><span class="line">为什么都是or拼接，in可以而not in不可以呢，可以把not in理解为后面的and表达式就知道了，因为empno=null为null，</span><br><span class="line">也就相当于false，导致整个表达式为false，无论传何值都为false，自然无法返回数据</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="3-6、模糊查询"><a href="#3-6、模糊查询" class="headerlink" title="3.6、模糊查询"></a>3.6、模糊查询</h3><ol>
<li><p>说明</p>
<p>LIKE子句的功能是提供了模糊查找的操作,程序里出现的搜索操作，都属于LIKE子句的实现,但是要想使用LIKE子句则必须认识两个匹配符号</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">匹配单个字符：_   --匹配任意一个字符</span><br><span class="line">匹配任意多个字符：%   --匹配 0 个、1 个或多个任意字符</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">字段 LIKE 关键字</span><br></pre></td></tr></table></figure>
</li>
<li><p>示例代码</p>
<p>1、查询出雇员第二个字母为“L”的雇员信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select * </span><br><span class="line">from emp </span><br><span class="line">WHERE ename like &apos;_L%&apos;;</span><br></pre></td></tr></table></figure>
<p>2、查询出雇员姓名以字母“S”开头的雇员信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * </span><br><span class="line">FROM emp </span><br><span class="line">WHERE ename like &apos;S%&apos;</span><br></pre></td></tr></table></figure>
<p>3、查询出雇员姓名包含字母“S”的雇员信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * </span><br><span class="line">FROM emp </span><br><span class="line">WHERE ename like &apos;%S%&apos;</span><br></pre></td></tr></table></figure>
<p>4、查询入职年份为81年的雇员信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * </span><br><span class="line">FROM emp </span><br><span class="line">WHERE hiredate like &apos;%81&apos;</span><br></pre></td></tr></table></figure>
<p>5、查询工资值中包含数字5的雇员信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * </span><br><span class="line">FROM emp </span><br><span class="line">WHERE sal like &apos;%5%&apos;</span><br></pre></td></tr></table></figure>
<p>6、查询所有员工中ename 包含数字1 ,或者入职日期中包含数字1或者工资中含有数字5</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * </span><br><span class="line">FROM emp </span><br><span class="line">WHERE ename LIKE &apos;%1%&apos; OR hiredate LIKE &apos;%1%&apos; OR sal LIKE &apos;%5%&apos;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询名为SCOTT 的员工的所有信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select * from emp where ename = &apos;SCOTT&apos;;</span><br><span class="line">等同于 select * from emp where ename like &apos;SCOTT&apos;;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="3-7、总结"><a href="#3-7、总结" class="headerlink" title="3.7、总结"></a>3.7、总结</h3><ol>
<li>作用：对SQL语句返回的数据集进行筛选</li>
<li>位置：紧跟在FROM子句后</li>
<li>内容：由一至多个限定条件组成，限定条件由表达式, 比较符, 字面值组成。所有字符串和日期要用单引号括起来，数值不需要单引号。</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/08/27/4.查询（控制行）/" data-id="cjlc5t05l0007zctqbrb6knrm" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/08/27/13.约束/">(no title)</a>
          </li>
        
          <li>
            <a href="/2018/08/27/12.数据类型/">(no title)</a>
          </li>
        
          <li>
            <a href="/2018/08/27/11.创建表/">(no title)</a>
          </li>
        
          <li>
            <a href="/2018/08/27/10.增删改/">(no title)</a>
          </li>
        
          <li>
            <a href="/2018/08/27/9.查询（子查询）/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body>
</html>